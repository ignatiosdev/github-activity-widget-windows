{"version":3,"file":"chunk-app_components_search_qbsearch-input-element_ts-xxxxxxxxxxxx.js","mappings":"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","sources":["app/components/search/experiments.ts","app/components/search/parsing/common.ts","app/components/search/providers/history.ts","app/components/search/suggestions/languages.ts","app/components/search/providers/languages.ts","app/components/search/providers/repos.ts","app/components/search/providers/saved.ts","app/components/search/providers/owners.ts","app/components/search/providers/fixed.ts","app/components/search/providers/teams.ts","app/components/search/providers/projects.ts","app/components/search/providers/blackbird.ts","app/components/search/providers/input.ts","app/components/search/suggestions/explore-pages.ts","app/components/search/providers/explore.ts","app/components/search/providers/copilot.ts","app/components/search/qbsearch-input-element.ts","ui/packages/blackbird-warm-caches/blackbird-warm-caches.ts","ui/packages/copilot-auth-token/auth-token.ts","ui/packages/copilot-auth-token/copilot-auth-token.ts","ui/packages/safe-storage/session-storage.ts","ui/packages/soft-nav/events.ts","ui/packages/soft-nav/state.ts","ui/packages/soft-nav/states.ts","ui/packages/soft-nav/stats.ts","ui/packages/soft-nav/utils.ts","ui/packages/soft-navigate/soft-navigate.ts","ui/packages/verified-fetch/verified-fetch.ts"],"sourcesContent":["import safeStorage from '@github-ui/safe-storage'\n\nconst experimentsLocalStorageKey = 'blackbird_experiments'\nconst experimentsDebugScoringKey = 'blackbird_debug_scoring'\n\nexport function getBlackbirdExperiments(): string[] {\n  const experiments = safeStorage('localStorage').getItem(experimentsLocalStorageKey)\n  if (!experiments) return []\n\n  return experiments.split(',')\n}\n\nexport function setBlackbirdExperiments(experiments: string[]): void {\n  safeStorage('localStorage').setItem(experimentsLocalStorageKey, experiments.join(','))\n}\n\nexport function debugScoringInfoEnabled(): boolean {\n  const enabled = safeStorage('localStorage').getItem(experimentsDebugScoringKey)\n  return enabled !== null\n}\n\nexport function setDebugScoringInfoEnabled(enabled: boolean): void {\n  if (enabled) {\n    safeStorage('localStorage').setItem(experimentsDebugScoringKey, '1')\n  } else {\n    safeStorage('localStorage').removeItem(experimentsDebugScoringKey)\n  }\n}\n","// important to import type so we don't bring in all the code\nimport type {BaseNode, ContentNode, QualifierNode, NodeWithChildren} from '@github/blackbird-parser'\n\nexport const enum CaretPositionKind {\n  Is,\n  Repository,\n  Owner,\n  Language,\n  Path,\n  Regex,\n  Text,\n  Saved,\n  OtherQualifier,\n}\n\nexport function isQualifier(node: BaseNode): node is QualifierNode {\n  return !!(node as QualifierNode).qualifier\n}\n\nexport function isSavedQualifier(node: BaseNode): node is QualifierNode {\n  return !!isQualifier(node) && node.qualifier === 'Saved'\n}\n\nconst slashRegex = new RegExp('\\\\/', 'g')\n\nexport function shouldRedirectInsteadOfSearch(node: BaseNode, path: string): string | null {\n  // If the entire user's query is `repo:a/b`, it doesn't make sense to search\n  // within the repository with no actual query. They probably want to navigate to\n  // the repository itself, so let's just direct them there instead.\n  if (isQualifier(node) && isContentNode(node.content)) {\n    if (node.qualifier === 'Repo') {\n      // Only redirect if it looks like a repository, i.e. contains exactly one slash\n      if ([...node.content.value.toString().matchAll(slashRegex)].length !== 1) {\n        return null\n      }\n    } else if (node.qualifier === 'Org') {\n      // Only redirect if it looks like an organization, i.e. contains exactly zero slashes\n      if ([...node.content.value.toString().matchAll(slashRegex)].length !== 0) {\n        return null\n      }\n    } else {\n      // Don't do this redirect behaviour for any other qualifier type\n      return null\n    }\n\n    // Disallow redirects to repositories or organizations that begin with a /, since\n    // that would form an absolute URL!\n    if (node.content.value.toString().startsWith('/')) {\n      return null\n    }\n\n    const redirectURL = `/${node.content.value.toString().split('/').map(encodeURIComponent).join('/')}`\n\n    // If the redirect would take them to the path they're already on, then it's pointless, so\n    // just do a search instead.\n    if (redirectURL === path) {\n      return null\n    }\n\n    return redirectURL\n  }\n\n  return null\n}\n\n// this function is unfortunately duplicated from @github/blackbird-parser so that the code that\n// uses it doesn't import that whole huge module\nexport function isContentNode(node: BaseNode): node is ContentNode {\n  return (node as ContentNode).value !== undefined\n}\n\nexport function hasChildren(node: BaseNode): node is NodeWithChildren {\n  return !!(node as NodeWithChildren).children\n}\n\nexport function containsQualifier(node: BaseNode, qualifierKind: string): boolean {\n  if (isQualifier(node) && node.qualifier === qualifierKind) {\n    return true\n  }\n\n  if (hasChildren(node)) {\n    for (const child of node.children) {\n      if (containsQualifier(child, qualifierKind)) {\n        return true\n      }\n    }\n  }\n  return false\n}\n\n// Extract all of the text nodes from the AST, ignoring qualifiers. For example,\n// the query `lang:typescript repo:github/atom asdf` would return `['asdf']`.\nexport function extractTextQuery(node: BaseNode): string {\n  if (hasChildren(node)) {\n    return node.children\n      .map(extractTextQuery)\n      .filter(x => x.length > 0)\n      .join(' ')\n  }\n\n  if (isQualifier(node) || node.kind === 'Regex') {\n    return ''\n  }\n\n  if (isContentNode(node)) {\n    return node.value.toString()\n  }\n\n  return ''\n}\n\ninterface RepoOrgScope {\n  kind: 'repo' | 'org' | 'saved'\n  value: string\n}\n\n// Extract all repo and orgs mentioned in the query\nexport function extractRepoOrgScopes(node: BaseNode): RepoOrgScope[] {\n  if (node.kind === 'Not') {\n    return []\n  }\n\n  if (hasChildren(node)) {\n    return node.children.map(extractRepoOrgScopes).flat()\n  }\n\n  if (isQualifier(node)) {\n    if (node.qualifier === 'Repo' && isContentNode(node.content)) {\n      return [{kind: 'repo', value: node.content.value.toString()}]\n    } else if (node.qualifier === 'Org' && isContentNode(node.content)) {\n      return [{kind: 'org', value: node.content.value.toString()}]\n    } else if (isSavedQualifier(node) && isContentNode(node.content)) {\n      return [{kind: 'saved', value: node.content.value.toString()}]\n    }\n  }\n  return []\n}\n\nexport function restrictToScopedOrgs(node: BaseNode, orgs: string[]): string[] {\n  const repoOrgScopes = new Set(\n    extractRepoOrgScopes(node)\n      .map(scope => {\n        if (scope.kind === 'org') {\n          return scope.value\n        } else if (scope.kind === 'repo' && scope.value.includes('/')) {\n          return scope.value.split('/')[0]\n        } else {\n          return null\n        }\n      })\n      .filter(s => s !== null)\n      .map(s => s?.toLowerCase()),\n  )\n\n  if (repoOrgScopes.size === 0) {\n    return orgs\n  }\n\n  return orgs.filter(org => repoOrgScopes.has(org.toLowerCase()))\n}\n","import type {SearchProvider, QueryEvent} from '@github-ui/query-builder-element/query-builder-api'\nimport {SearchItem, Octicon} from '@github-ui/query-builder-element/query-builder-api'\nimport type {QueryBuilderElement} from '@github-ui/query-builder-element'\nimport safeStorage from '@github-ui/safe-storage'\nimport {CaretPositionKind} from '../parsing/common'\nimport type {ParsedIntermediateRepresentation} from '../qbsearch-input-element'\n\nconst safeLocalStorage = safeStorage('localStorage')\n\nexport class HistoryProvider extends EventTarget implements SearchProvider {\n  priority = 5\n  name = 'History'\n  singularItemName = 'history'\n  value = 'history'\n  type = 'search' as const\n\n  constructor(public queryBuilder: QueryBuilderElement) {\n    super()\n    this.queryBuilder.addEventListener('query', this)\n  }\n\n  handleEvent(event: QueryEvent) {\n    const state = event.parsedMetadata as ParsedIntermediateRepresentation | undefined\n    if (!state || state.caretPositionKind !== CaretPositionKind.Text) {\n      return []\n    }\n\n    const query = event.toString()\n    let suggestions: string[] = JSON.parse(safeLocalStorage.getItem('github-search-history') ?? '[]')\n\n    const trimmedQuery = state.query.trim()\n    if (trimmedQuery.length !== 0) {\n      return []\n    }\n\n    // Deduplicate suggestions\n    const seen: Record<string, boolean> = {}\n    suggestions = suggestions.filter(item => {\n      if (!seen[item]) {\n        seen[item] = true\n        return true\n      }\n      return false\n    })\n\n    let suggestionCount = 0\n    for (const suggestion of suggestions) {\n      if (suggestionCount >= 5) break\n\n      const historyQuery = suggestion.trim()\n      if (historyQuery.startsWith(query)) {\n        suggestionCount += 1\n        this.dispatchEvent(\n          new SearchItem({\n            value: historyQuery,\n            icon: Octicon.Search,\n            scope: 'GENERAL',\n            priority: historyQuery.length,\n            action: {url: `/search?q=${historyQuery}`},\n          }),\n        )\n      }\n    }\n  }\n}\n","export interface Language {\n  name: string\n  color: string\n}\n\n// NOTE: this is not intended to be an exhaustive list of supported languages,\n// but just a list suitable to be rendered as suggestions. The list is copied\n// from Enry's data (which is what is used within Blackbird's backend), see\n// https://github.com/src-d/enry/blob/master/data/colors.go\nexport const PopularLanguages: Language[] = [\n  {name: 'C++', color: '#f34b7d'},\n  {name: 'Go', color: '#00ADD8'},\n  {name: 'Java', color: '#b07219'},\n  {name: 'JavaScript', color: '#f1e05a'},\n  {name: 'PHP', color: '#4F5D95'},\n  {name: 'Python', color: '#3572A5'},\n  {name: 'Ruby', color: '#701516'},\n  {name: 'TypeScript', color: '#2b7489'},\n  {name: 'ABAP', color: '#E8274B'},\n  {name: 'AGS Script', color: '#B9D9FF'},\n  {name: 'AMPL', color: '#E6EFBB'},\n  {name: 'ANTLR', color: '#9DC3FF'},\n  {name: 'API Blueprint', color: '#2ACCA8'},\n  {name: 'APL', color: '#5A8164'},\n  {name: 'ASP', color: '#6a40fd'},\n  {name: 'ATS', color: '#1ac620'},\n  {name: 'ActionScript', color: '#882B0F'},\n  {name: 'Ada', color: '#02f88c'},\n  {name: 'Agda', color: '#315665'},\n  {name: 'Alloy', color: '#64C800'},\n  {name: 'AngelScript', color: '#C7D7DC'},\n  {name: 'AppleScript', color: '#101F1F'},\n  {name: 'Arc', color: '#aa2afe'},\n  {name: 'AspectJ', color: '#a957b0'},\n  {name: 'Assembly', color: '#6E4C13'},\n  {name: 'Asymptote', color: '#4a0c0c'},\n  {name: 'AutoHotkey', color: '#6594b9'},\n  {name: 'AutoIt', color: '#1C3552'},\n  {name: 'Ballerina', color: '#FF5000'},\n  {name: 'Batchfile', color: '#C1F12E'},\n  {name: 'BlitzMax', color: '#cd6400'},\n  {name: 'Boo', color: '#d4bec1'},\n  {name: 'C', color: '#555555'},\n  {name: 'C#', color: '#178600'},\n  {name: 'CSS', color: '#563d7c'},\n  {name: 'Ceylon', color: '#dfa535'},\n  {name: 'Chapel', color: '#8dc63f'},\n  {name: 'Cirru', color: '#ccccff'},\n  {name: 'Clarion', color: '#db901e'},\n  {name: 'Clean', color: '#3F85AF'},\n  {name: 'Click', color: '#E4E6F3'},\n  {name: 'Clojure', color: '#db5855'},\n  {name: 'CoffeeScript', color: '#244776'},\n  {name: 'ColdFusion', color: '#ed2cd6'},\n  {name: 'Common Lisp', color: '#3fb68b'},\n  {name: 'Common Workflow Language', color: '#B5314C'},\n  {name: 'Component Pascal', color: '#B0CE4E'},\n  {name: 'Crystal', color: '#000100'},\n  {name: 'Cuda', color: '#3A4E3A'},\n  {name: 'D', color: '#ba595e'},\n  {name: 'DM', color: '#447265'},\n  {name: 'Dart', color: '#00B4AB'},\n  {name: 'DataWeave', color: '#003a52'},\n  {name: 'Dhall', color: '#dfafff'},\n  {name: 'Dockerfile', color: '#384d54'},\n  {name: 'Dogescript', color: '#cca760'},\n  {name: 'Dylan', color: '#6c616e'},\n  {name: 'E', color: '#ccce35'},\n  {name: 'ECL', color: '#8a1267'},\n  {name: 'EQ', color: '#a78649'},\n  {name: 'Eiffel', color: '#946d57'},\n  {name: 'Elixir', color: '#6e4a7e'},\n  {name: 'Elm', color: '#60B5CC'},\n  {name: 'Emacs Lisp', color: '#c065db'},\n  {name: 'EmberScript', color: '#FFF4F3'},\n  {name: 'Erlang', color: '#B83998'},\n  {name: 'F#', color: '#b845fc'},\n  {name: 'F*', color: '#572e30'},\n  {name: 'FLUX', color: '#88ccff'},\n  {name: 'Factor', color: '#636746'},\n  {name: 'Fancy', color: '#7b9db4'},\n  {name: 'Fantom', color: '#14253c'},\n  {name: 'Forth', color: '#341708'},\n  {name: 'Fortran', color: '#4d41b1'},\n  {name: 'FreeMarker', color: '#0050b2'},\n  {name: 'Frege', color: '#00cafe'},\n  {name: 'G-code', color: '#D08CF2'},\n  {name: 'GDScript', color: '#355570'},\n  {name: 'Game Maker Language', color: '#71b417'},\n  {name: 'Genie', color: '#fb855d'},\n  {name: 'Gherkin', color: '#5B2063'},\n  {name: 'Glyph', color: '#c1ac7f'},\n  {name: 'Gnuplot', color: '#f0a9f0'},\n  {name: 'Groovy', color: '#e69f56'},\n  {name: 'HTML', color: '#e34c26'},\n  {name: 'Hack', color: '#878787'},\n  {name: 'Harbour', color: '#0e60e3'},\n  {name: 'Haskell', color: '#5e5086'},\n  {name: 'Haxe', color: '#df7900'},\n  {name: 'HCL', color: '#844fba'},\n  {name: 'HiveQL', color: '#dce200'},\n  {name: 'HolyC', color: '#ffefaf'},\n  {name: 'Hy', color: '#7790B2'},\n  {name: 'IDL', color: '#a3522f'},\n  {name: 'Idris', color: '#b30000'},\n  {name: 'Io', color: '#a9188d'},\n  {name: 'Ioke', color: '#078193'},\n  {name: 'Isabelle', color: '#FEFE00'},\n  {name: 'J', color: '#9EEDFF'},\n  {name: 'JSONiq', color: '#40d47e'},\n  {name: 'Jolie', color: '#843179'},\n  {name: 'Jsonnet', color: '#0064bd'},\n  {name: 'Julia', color: '#a270ba'},\n  {name: 'Jupyter Notebook', color: '#DA5B0B'},\n  {name: 'KRL', color: '#28430A'},\n  {name: 'Kotlin', color: '#F18E33'},\n  {name: 'LFE', color: '#4C3023'},\n  {name: 'LLVM', color: '#185619'},\n  {name: 'LSL', color: '#3d9970'},\n  {name: 'Lasso', color: '#999999'},\n  {name: 'Lex', color: '#DBCA00'},\n  {name: 'LiveScript', color: '#499886'},\n  {name: 'LookML', color: '#652B81'},\n  {name: 'Lua', color: '#000080'},\n  {name: 'MATLAB', color: '#e16737'},\n  {name: 'MAXScript', color: '#00a6a6'},\n  {name: 'MQL4', color: '#62A8D6'},\n  {name: 'MQL5', color: '#4A76B8'},\n  {name: 'MTML', color: '#b7e1f4'},\n  {name: 'Makefile', color: '#427819'},\n  {name: 'Markdown', color: '#083fa1'},\n  {name: 'Mask', color: '#f97732'},\n  {name: 'Max', color: '#c4a79c'},\n  {name: 'Mercury', color: '#ff2b2b'},\n  {name: 'Meson', color: '#007800'},\n  {name: 'Metal', color: '#8f14e9'},\n  {name: 'Mirah', color: '#c7a938'},\n  {name: 'Modula-3', color: '#223388'},\n  {name: 'NCL', color: '#28431f'},\n  {name: 'Nearley', color: '#990000'},\n  {name: 'Nemerle', color: '#3d3c6e'},\n  {name: 'NetLinx', color: '#0aa0ff'},\n  {name: 'NetLinx+ERB', color: '#747faa'},\n  {name: 'NetLogo', color: '#ff6375'},\n  {name: 'NewLisp', color: '#87AED7'},\n  {name: 'Nextflow', color: '#3ac486'},\n  {name: 'Nim', color: '#37775b'},\n  {name: 'Nit', color: '#009917'},\n  {name: 'Nix', color: '#7e7eff'},\n  {name: 'Nu', color: '#c9df40'},\n  {name: 'OCaml', color: '#3be133'},\n  {name: 'ObjectScript', color: '#424893'},\n  {name: 'Objective-C', color: '#438eff'},\n  {name: 'Objective-C++', color: '#6866fb'},\n  {name: 'Objective-J', color: '#ff0c5a'},\n  {name: 'Omgrofl', color: '#cabbff'},\n  {name: 'Opal', color: '#f7ede0'},\n  {name: 'Oxygene', color: '#cdd0e3'},\n  {name: 'Oz', color: '#fab738'},\n  {name: 'P4', color: '#7055b5'},\n  {name: 'PLSQL', color: '#dad8d8'},\n  {name: 'Pan', color: '#cc0000'},\n  {name: 'Papyrus', color: '#6600cc'},\n  {name: 'Parrot', color: '#f3ca0a'},\n  {name: 'Pascal', color: '#E3F171'},\n  {name: 'Pawn', color: '#dbb284'},\n  {name: 'Pep8', color: '#C76F5B'},\n  {name: 'Perl', color: '#0298c3'},\n  {name: 'Perl 6', color: '#0000fb'},\n  {name: 'PigLatin', color: '#fcd7de'},\n  {name: 'Pike', color: '#005390'},\n  {name: 'PogoScript', color: '#d80074'},\n  {name: 'PostScript', color: '#da291c'},\n  {name: 'PowerBuilder', color: '#8f0f8d'},\n  {name: 'PowerShell', color: '#012456'},\n  {name: 'Processing', color: '#0096D8'},\n  {name: 'Prolog', color: '#74283c'},\n  {name: 'Propeller Spin', color: '#7fa2a7'},\n  {name: 'Puppet', color: '#302B6D'},\n  {name: 'PureBasic', color: '#5a6986'},\n  {name: 'PureScript', color: '#1D222D'},\n  {name: 'Protocol Buffers', color: '#CCCCCC'},\n  {name: 'QML', color: '#44a51c'},\n  {name: 'Quake', color: '#882233'},\n  {name: 'R', color: '#198CE7'},\n  {name: 'RAML', color: '#77d9fb'},\n  {name: 'Racket', color: '#3c5caa'},\n  {name: 'Ragel', color: '#9d5200'},\n  {name: 'Rascal', color: '#fffaa0'},\n  {name: 'Rebol', color: '#358a5b'},\n  {name: 'Red', color: '#f50000'},\n  {name: \"Ren'Py\", color: '#ff7f7f'},\n  {name: 'Ring', color: '#2D54CB'},\n  {name: 'Roff', color: '#ecdebe'},\n  {name: 'Rouge', color: '#cc0088'},\n  {name: 'Rust', color: '#dea584'},\n  {name: 'SAS', color: '#B34936'},\n  {name: 'SQF', color: '#3F3F3F'},\n  {name: 'SQL', color: '#e38c00'},\n  {name: 'SRecode Template', color: '#348a34'},\n  {name: 'SaltStack', color: '#646464'},\n  {name: 'Scala', color: '#c22d40'},\n  {name: 'Scheme', color: '#1e4aec'},\n  {name: 'Self', color: '#0579aa'},\n  {name: 'Shell', color: '#89e051'},\n  {name: 'Shen', color: '#120F14'},\n  {name: 'Slash', color: '#007eff'},\n  {name: 'Slice', color: '#003fa2'},\n  {name: 'Smalltalk', color: '#596706'},\n  {name: 'Solidity', color: '#AA6746'},\n  {name: 'SourcePawn', color: '#5c7611'},\n  {name: 'Squirrel', color: '#800000'},\n  {name: 'Stan', color: '#b2011d'},\n  {name: 'Standard ML', color: '#dc566d'},\n  {name: 'SuperCollider', color: '#46390b'},\n  {name: 'Swift', color: '#ffac45'},\n  {name: 'SystemVerilog', color: '#DAE1C2'},\n  {name: 'TI Program', color: '#A0AA87'},\n  {name: 'Tcl', color: '#e4cc98'},\n  {name: 'TeX', color: '#3D6117'},\n  {name: 'Terra', color: '#00004c'},\n  {name: 'Turing', color: '#cf142b'},\n  {name: 'UnrealScript', color: '#a54c4d'},\n  {name: 'VCL', color: '#148AA8'},\n  {name: 'VHDL', color: '#adb2cb'},\n  {name: 'Vala', color: '#fbe5cd'},\n  {name: 'Verilog', color: '#b2b7f8'},\n  {name: 'Vim script', color: '#199f4b'},\n  {name: 'Visual Basic', color: '#945db7'},\n  {name: 'Volt', color: '#1F1F1F'},\n  {name: 'Vue', color: '#2c3e50'},\n  {name: 'WebAssembly', color: '#04133b'},\n  {name: 'Wollok', color: '#a23738'},\n  {name: 'X10', color: '#4B6BEF'},\n  {name: 'XC', color: '#99DA07'},\n  {name: 'XQuery', color: '#5232e7'},\n  {name: 'XSLT', color: '#EB8CEB'},\n  {name: 'YARA', color: '#220000'},\n  {name: 'YASnippet', color: '#32AB90'},\n  {name: 'Yacc', color: '#4B6C4B'},\n  {name: 'ZAP', color: '#0d665e'},\n  {name: 'ZIL', color: '#dc75e5'},\n  {name: 'ZenScript', color: '#00BCD1'},\n  {name: 'Zephir', color: '#118f9e'},\n  {name: 'Zig', color: '#ec915c'},\n  {name: 'eC', color: '#913960'},\n  {name: 'mcfunction', color: '#E22837'},\n  {name: 'nesC', color: '#94B0C7'},\n  {name: 'ooc', color: '#b0b77e'},\n  {name: 'sed', color: '#64b970'},\n  {name: 'wdl', color: '#42f1f4'},\n  {name: 'wisp', color: '#7582D1'},\n  {name: 'xBase', color: '#403a40'},\n]\n","import {filterSort} from '@github-ui/filter-sort'\nimport {html} from '@github-ui/jtml-shimmed'\nimport {compare, fuzzyScore} from '@github-ui/fuzzy-filter'\nimport type {QueryEvent, CustomIcon, FilterProvider} from '@github-ui/query-builder-element/query-builder-api'\nimport {FilterItem} from '@github-ui/query-builder-element/query-builder-api'\nimport type {QueryBuilderElement} from '@github-ui/query-builder-element'\nimport type {Language} from '../suggestions/languages'\nimport {PopularLanguages} from '../suggestions/languages'\nimport {CaretPositionKind, isContentNode, isQualifier} from '../parsing/common'\nimport type {ParsedIntermediateRepresentation} from '../qbsearch-input-element'\nimport type {SafeHTMLString} from '@github-ui/safe-html'\n\nexport class LanguagesProvider extends EventTarget implements FilterProvider {\n  priority = 10\n  name = 'Languages'\n  singularItemName = 'language'\n  value = 'language'\n  type = 'filter' as const\n  manuallyDetermineFilterEligibility = true\n\n  constructor(public queryBuilder: QueryBuilderElement) {\n    super()\n    this.queryBuilder.addEventListener('query', this)\n  }\n\n  #icon(color: string): CustomIcon {\n    const node = document.createElement('div')\n    const tmpl = html`<div\n      style=\"border-radius: 8px; display: inline-block; height: 10px; width: 10px; background-color: ${color}\"\n    ></div>`\n\n    tmpl.renderInto(node)\n\n    return {\n      html: node.innerHTML as SafeHTMLString,\n    }\n  }\n\n  handleEvent(event: QueryEvent) {\n    const state = event.parsedMetadata as ParsedIntermediateRepresentation | undefined\n\n    if (!state || state.caretPositionKind !== CaretPositionKind.Language) {\n      return []\n    }\n\n    let term = ''\n\n    if (state.caretSelectedNode && isQualifier(state.caretSelectedNode)) {\n      if (isContentNode(state.caretSelectedNode.content)) {\n        term = state.caretSelectedNode.content.value as string\n      }\n    } else {\n      return []\n    }\n\n    let suggestions: Language[] = PopularLanguages.slice(0, 7)\n    if (term.length === 1) {\n      suggestions = PopularLanguages.filter(r => r.name.startsWith(term.toUpperCase())).slice(0, 7)\n    } else if (term.length > 1) {\n      const fuzzyQuery = term.replace(/\\s/g, '')\n      const key = (r: {name: string; color: string}) => {\n        const score = fuzzyScore(r.name, fuzzyQuery)\n        return score > 0 ? {score, text: r.name} : null\n      }\n      suggestions = filterSort(PopularLanguages, key, compare)\n    }\n\n    const suggestionCount = 0\n    for (const suggestion of suggestions) {\n      if (suggestionCount >= 8) break\n\n      let rewriteStart = state.caretSelectedNode.location.end\n      let rewriteEnd = state.caretSelectedNode.location.end\n      if (isContentNode(state.caretSelectedNode.content)) {\n        rewriteStart = state.caretSelectedNode.content.location.start\n        rewriteEnd = state.caretSelectedNode.content.location.end\n      }\n\n      const quotedName = suggestion.name.includes(' ') ? `\"${suggestion.name}\"` : suggestion.name\n      const newQuery = `${state.query.slice(0, rewriteStart) + quotedName} ${state.query.slice(rewriteEnd)}`\n\n      this.dispatchEvent(\n        new FilterItem({\n          filter: 'lang',\n          value: suggestion.name,\n          icon: this.#icon(suggestion.color),\n          priority: 0,\n          action: {\n            query: newQuery,\n            replaceQueryWith: newQuery,\n            moveCaretTo: rewriteStart + quotedName.length + 1,\n          },\n        }),\n      )\n    }\n  }\n}\n","import {filterSort} from '@github-ui/filter-sort'\nimport {compare, fuzzyScore} from '@github-ui/fuzzy-filter'\nimport type {\n  QueryEvent,\n  FilterProvider,\n  QueryBuilderAction,\n  SearchProvider,\n} from '@github-ui/query-builder-element/query-builder-api'\nimport {FilterItem, Octicon, SearchItem} from '@github-ui/query-builder-element/query-builder-api'\nimport type {QueryBuilderElement} from '@github-ui/query-builder-element'\nimport {getSuggestions} from '@github-ui/jump-to-element/model'\nimport {CaretPositionKind, extractRepoOrgScopes, extractTextQuery, isContentNode, isQualifier} from '../parsing/common'\nimport type {ParsedIntermediateRepresentation} from '../qbsearch-input-element'\n\nclass ReposProviderBase extends EventTarget {\n  #input: HTMLElement\n  #suggestedRepos: string[] | null = null\n\n  constructor(input: HTMLElement) {\n    super()\n    this.#input = input\n  }\n\n  protected async getMatchingRepositories({state}: {state: ParsedIntermediateRepresentation}) {\n    let term = ''\n    const scopedOrgs: string[] = []\n    if (state.ast) {\n      const scopes = extractRepoOrgScopes(state.ast)\n      let isScopedToRepository = false\n      for (const scope of scopes) {\n        if (scope.kind === 'repo' || scope.kind === 'saved') {\n          isScopedToRepository = true\n        } else if (scope.kind === 'org') {\n          scopedOrgs.push(scope.value.toLowerCase())\n        }\n      }\n\n      // Don't suggest repositories if we are scoped to a repo and aren't currently\n      // editing that qualifier\n      if (isScopedToRepository && state.caretPositionKind !== CaretPositionKind.Repository) {\n        return []\n      }\n\n      term = extractTextQuery(state.ast)\n    }\n\n    if (state.caretSelectedNode && isQualifier(state.caretSelectedNode)) {\n      if (isContentNode(state.caretSelectedNode.content)) {\n        term = state.caretSelectedNode.content.value as string\n      } else {\n        term = ''\n      }\n    }\n\n    if (this.#suggestedRepos === null) {\n      this.#suggestedRepos = (await getSuggestions(this.#input)).filter(r => r.type === 'Repository').map(r => r.name)\n    }\n\n    let matches = this.#suggestedRepos\n    if (term.length > 0) {\n      const fuzzyQuery = term.replace(/\\s/g, '')\n      const key = (r: string) => {\n        const score = fuzzyScore(r, fuzzyQuery)\n        return score > 0 ? {score, text: r} : null\n      }\n      matches = filterSort(this.#suggestedRepos, key, compare)\n    }\n\n    // Filter matches match orgs specified in the query\n    if (scopedOrgs.length > 0) {\n      matches = matches.filter(r => {\n        const org = r.split('/')[0]!.toLowerCase()\n        return scopedOrgs.find(o => org.startsWith(o))\n      })\n    }\n\n    return matches\n  }\n}\n\nexport class ReposFilterProvider extends ReposProviderBase implements FilterProvider {\n  priority = 6\n  name = 'Repositories'\n  singularItemName = 'repository'\n  value = 'repository-filter'\n  type = 'filter' as const\n  manuallyDetermineFilterEligibility = true\n\n  constructor(\n    public queryBuilder: QueryBuilderElement,\n    input: HTMLElement,\n  ) {\n    super(input)\n    this.queryBuilder.addEventListener('query', this)\n  }\n\n  async handleEvent(event: QueryEvent) {\n    const state = event.parsedMetadata as ParsedIntermediateRepresentation | undefined\n    const hasFocus = this.queryBuilder.hasFocus()\n    if (!state || !hasFocus) {\n      return []\n    }\n\n    if (\n      state.caretPositionKind !== CaretPositionKind.Repository &&\n      state.caretPositionKind !== CaretPositionKind.Owner\n    ) {\n      return []\n    }\n\n    const matches = await this.getMatchingRepositories({state})\n\n    for (const suggestion of matches.slice(0, 5)) {\n      let action: QueryBuilderAction = {\n        url: `/${suggestion}`,\n      }\n\n      if (state.caretSelectedNode && isQualifier(state.caretSelectedNode)) {\n        let rewriteStart = state.caretSelectedNode.location.end\n        let rewriteEnd = state.caretSelectedNode.location.end\n        if (isContentNode(state.caretSelectedNode.content)) {\n          rewriteStart = state.caretSelectedNode.content.location.start\n          rewriteEnd = state.caretSelectedNode.content.location.end\n        }\n\n        const newQuery = `${state.query.slice(0, rewriteStart) + suggestion} ${state.query.slice(rewriteEnd)}`\n        action = {\n          replaceQueryWith: newQuery,\n          moveCaretTo: rewriteStart + suggestion.length + 1,\n        }\n      }\n\n      this.dispatchEvent(\n        new FilterItem({\n          filter: 'repo',\n          value: suggestion,\n          icon: Octicon.Repo,\n          priority: 0,\n          action,\n        }),\n      )\n    }\n  }\n}\n\nexport class ReposSearchProvider extends ReposProviderBase implements SearchProvider {\n  priority = 6\n  name = 'Repositories'\n  singularItemName = 'repository'\n  value = 'repository-search'\n  type = 'search' as const\n  manuallyDetermineFilterEligibility = true\n\n  constructor(\n    public queryBuilder: QueryBuilderElement,\n    input: HTMLElement,\n  ) {\n    super(input)\n    this.queryBuilder.addEventListener('query', this)\n  }\n\n  async handleEvent(event: QueryEvent) {\n    const state = event.parsedMetadata as ParsedIntermediateRepresentation | undefined\n    const hasFocus = this.queryBuilder.hasFocus()\n    if (!state || !hasFocus || state.caretPositionKind !== CaretPositionKind.Text) {\n      return []\n    }\n\n    const matches = await this.getMatchingRepositories({\n      state,\n    })\n\n    for (const suggestion of matches.slice(0, 5)) {\n      this.dispatchEvent(\n        new SearchItem({\n          value: suggestion,\n          icon: Octicon.Repo,\n          priority: 0,\n          action: {\n            url: `/${suggestion}`,\n          },\n        }),\n      )\n    }\n  }\n}\n","import {filterSort} from '@github-ui/filter-sort'\nimport {compare, fuzzyScore} from '@github-ui/fuzzy-filter'\nimport type {QueryEvent, SearchProvider} from '@github-ui/query-builder-element/query-builder-api'\nimport {Octicon, SearchItem} from '@github-ui/query-builder-element/query-builder-api'\nimport type {QueryBuilderElement} from '@github-ui/query-builder-element'\nimport {CaretPositionKind, containsQualifier, isQualifier, isSavedQualifier, isContentNode} from '../parsing/common'\nimport type {ParsedIntermediateRepresentation} from '../qbsearch-input-element'\nimport type {CustomScope} from '../suggestions/types'\n\nexport class CustomScopeCache {\n  #cache: CustomScope[] = []\n  #filled: boolean\n\n  set(scopes: CustomScope[]) {\n    this.#cache = scopes\n    this.#filled = true\n  }\n\n  get() {\n    if (this.#filled) return this.#cache\n    return undefined\n  }\n\n  len() {\n    return this.#cache.length\n  }\n\n  clear() {\n    this.#filled = false\n    this.#cache = []\n  }\n}\n\nexport class SavedScopeProvider extends EventTarget implements SearchProvider {\n  priority = 4\n  name = 'Saved queries'\n  singularItemName = 'saved query'\n  value = 'saved query'\n  type = 'search' as const\n  #customScopesUrl: string | null\n  customScopesCache = new CustomScopeCache()\n\n  constructor(\n    public queryBuilder: QueryBuilderElement,\n    customScopesUrl: string,\n  ) {\n    super()\n    this.#customScopesUrl = customScopesUrl\n    this.queryBuilder.addEventListener('query', this)\n  }\n\n  async fetchSuggestions(): Promise<CustomScope[]> {\n    let data = []\n    if (this.#customScopesUrl) {\n      const response = await fetch(this.#customScopesUrl, {\n        method: 'GET',\n        mode: 'same-origin',\n        headers: {\n          Accept: 'application/json',\n        },\n      })\n      if (!response.ok) {\n        return []\n      }\n      data = await response.json()\n      this.#replaceCustomScopesCache(data)\n    }\n    return data\n  }\n\n  #replaceCustomScopesCache(data: CustomScope[]): void {\n    this.customScopesCache.set(data)\n  }\n\n  async handleEvent(event: QueryEvent) {\n    const state = event.parsedMetadata as ParsedIntermediateRepresentation | undefined\n\n    if (\n      !state ||\n      (state.caretPositionKind !== CaretPositionKind.Text && state.caretPositionKind !== CaretPositionKind.Saved)\n    ) {\n      return []\n    }\n\n    // If the query already contains a saved search, and the caret isn't over it, don't suggest any more\n    if (state.caretPositionKind !== CaretPositionKind.Saved && state.ast && containsQualifier(state.ast, 'Saved')) {\n      return []\n    }\n\n    // If the query already contains an org or repo term, don't suggest saved searches\n    if (state.ast && (containsQualifier(state.ast, 'Repo') || containsQualifier(state.ast, 'Org'))) {\n      return []\n    }\n\n    let term = ''\n    if (state.caretSelectedNode) {\n      if (isSavedQualifier(state.caretSelectedNode)) {\n        if (isContentNode(state.caretSelectedNode.content)) {\n          term = String(state.caretSelectedNode.content.value)\n        }\n      } else if (isContentNode(state.caretSelectedNode)) {\n        term = String(state.caretSelectedNode.value)\n      }\n    }\n\n    let suggestions = this.customScopesCache.get()\n    if (suggestions === undefined) {\n      suggestions = await this.fetchSuggestions()\n    }\n\n    if (term.trim().length > 0) {\n      // Remove whitespace and quotes (which can surround saved searches)\n      const fuzzyQuery = term.replace(/[\\s\"]/g, '')\n      const key = (s: CustomScope) => {\n        const score = fuzzyScore(s.name, fuzzyQuery)\n        return score > 0 ? {score, text: s.name} : null\n      }\n      suggestions = filterSort(suggestions, key, compare)\n    }\n\n    for (const suggestion of suggestions) {\n      const qualifier = 'saved:'\n\n      let quotedName = suggestion.name.includes(' ') ? `\"${suggestion.name}\"` : suggestion.name\n\n      let replaceQueryWith = ''\n      if (state.query.endsWith(' ') || state.query === '') {\n        replaceQueryWith = `${state.query}${qualifier + quotedName} `\n      } else {\n        replaceQueryWith = `${state.query} ${qualifier + quotedName} `\n      }\n      let moveCaretTo = replaceQueryWith.length\n\n      if (state.caretSelectedNode && (isContentNode(state.caretSelectedNode) || isQualifier(state.caretSelectedNode))) {\n        const rewriteStart = state.caretSelectedNode.location.start\n        let rewriteEnd = state.caretSelectedNode.location.end\n        if (isQualifier(state.caretSelectedNode) && isContentNode(state.caretSelectedNode.content)) {\n          rewriteEnd = state.caretSelectedNode.content.location.end\n        }\n\n        const queryStart = state.query.slice(0, rewriteStart)\n        const queryEnd = state.query.slice(rewriteEnd).trimEnd()\n        if (queryEnd === '') {\n          quotedName += ' ' // Add a space if the insertion is at the end\n        }\n\n        const newQuery = queryStart + qualifier + quotedName + queryEnd\n        replaceQueryWith = newQuery\n        moveCaretTo = rewriteStart + qualifier.length + quotedName.length\n      }\n\n      this.dispatchEvent(\n        new SearchItem({\n          value: `saved:${suggestion.name}`,\n          icon: Octicon.Bookmark,\n          priority: 0,\n          action: {\n            replaceQueryWith,\n            moveCaretTo,\n          },\n        }),\n      )\n    }\n\n    if (state.caretPositionKind === CaretPositionKind.Saved) {\n      this.dispatchEvent(\n        new SearchItem({\n          value: `Manage saved searches`,\n          icon: Octicon.PlusCircle,\n          scope: 'COMMAND',\n          priority: 0,\n          action: {\n            commandName: 'blackbird-monolith.manageCustomScopes',\n            data: {},\n          },\n        }),\n      )\n    }\n  }\n}\n","import {filterSort} from '@github-ui/filter-sort'\nimport {compare, fuzzyScore} from '@github-ui/fuzzy-filter'\nimport type {QueryEvent, SearchProvider, QueryBuilderAction} from '@github-ui/query-builder-element/query-builder-api'\nimport {SearchItem, Octicon} from '@github-ui/query-builder-element/query-builder-api'\nimport type {QueryBuilderElement} from '@github-ui/query-builder-element'\nimport {getSuggestions} from '@github-ui/jump-to-element/model'\nimport {CaretPositionKind, extractRepoOrgScopes, extractTextQuery, isContentNode, isQualifier} from '../parsing/common'\nimport type {ParsedIntermediateRepresentation} from '../qbsearch-input-element'\n\nexport class OwnersProvider extends EventTarget implements SearchProvider {\n  priority = 5\n  name = 'Owners'\n  singularItemName = 'owner'\n  value = 'owner'\n  type = 'search' as const\n  manuallyDetermineFilterEligibility = true\n\n  #suggestedOwners: string[] | null = null\n  #input: HTMLElement\n\n  constructor(\n    public queryBuilder: QueryBuilderElement,\n    input: HTMLElement,\n  ) {\n    super()\n    this.queryBuilder.addEventListener('query', this)\n    this.#input = input\n  }\n\n  async handleEvent(event: QueryEvent) {\n    const state = event.parsedMetadata as ParsedIntermediateRepresentation | undefined\n    const hasFocus = this.queryBuilder.hasFocus()\n    if (!state || !hasFocus) {\n      return []\n    }\n\n    if (state.caretPositionKind === CaretPositionKind.Text && state.ast) {\n      // If the query is already scoped, don't suggest any more orgs\n      if (extractRepoOrgScopes(state.ast).length) {\n        return []\n      }\n      // Check that there are no existing scopes already applied\n    } else if (state.caretPositionKind !== CaretPositionKind.Owner) {\n      return []\n    }\n\n    let term = ''\n    const scopedOrgs: string[] = []\n    if (state.ast) {\n      term = extractTextQuery(state.ast)\n    }\n\n    if (state.caretSelectedNode && isQualifier(state.caretSelectedNode)) {\n      if (isContentNode(state.caretSelectedNode.content)) {\n        term = state.caretSelectedNode.content.value as string\n      } else {\n        term = ''\n      }\n    }\n\n    if (this.#suggestedOwners === null) {\n      const owners = (await getSuggestions(this.#input))\n        .filter(r => r.type === 'Repository')\n        .map(r => r.name.split('/')[0]!)\n      this.#suggestedOwners = [...new Set(owners)]\n    }\n\n    let matches = this.#suggestedOwners\n    if (term.length > 0) {\n      const fuzzyQuery = term.replace(/\\s/g, '')\n      const key = (r: string) => {\n        const score = fuzzyScore(r, fuzzyQuery)\n        return score > 0 ? {score, text: r} : null\n      }\n      matches = filterSort(this.#suggestedOwners, key, compare)\n    }\n\n    // Filter matches match orgs specified in the query\n    if (scopedOrgs.length > 0) {\n      matches = matches.filter(r => {\n        const org = r.split('/')[0]!.toLowerCase()\n        return scopedOrgs.find(o => org.startsWith(o))\n      })\n    }\n\n    for (const suggestion of matches.slice(0, 5)) {\n      let action: QueryBuilderAction = {\n        url: `/${suggestion}`,\n      }\n\n      if (state.caretSelectedNode && isQualifier(state.caretSelectedNode)) {\n        let rewriteStart = state.caretSelectedNode.location.end\n        let rewriteEnd = state.caretSelectedNode.location.end\n        if (isContentNode(state.caretSelectedNode.content)) {\n          rewriteStart = state.caretSelectedNode.content.location.start\n          rewriteEnd = state.caretSelectedNode.content.location.end\n        }\n\n        const newQuery = `${state.query.slice(0, rewriteStart) + suggestion} ${state.query.slice(rewriteEnd)}`\n        action = {\n          replaceQueryWith: newQuery,\n          moveCaretTo: rewriteStart + suggestion.length + 1,\n        }\n      }\n\n      this.dispatchEvent(\n        new SearchItem({\n          value: suggestion,\n          icon: Octicon.Repo,\n          priority: 0,\n          action,\n        }),\n      )\n    }\n  }\n}\n","import {filterSort} from '@github-ui/filter-sort'\nimport {compare, fuzzyScore} from '@github-ui/fuzzy-filter'\nimport type {QueryEvent, FilterProvider} from '@github-ui/query-builder-element/query-builder-api'\nimport {FilterItem, Octicon} from '@github-ui/query-builder-element/query-builder-api'\nimport type {QueryBuilderElement} from '@github-ui/query-builder-element'\nimport {CaretPositionKind, isContentNode, isQualifier} from '../parsing/common'\nimport type {ParsedIntermediateRepresentation} from '../qbsearch-input-element'\nimport type {BaseNode} from '@github/blackbird-parser'\n// eslint-disable-next-line import/no-namespace\nimport type * as Parsing from '../parsing/parsing'\n\nexport class FixedValuesProvider extends EventTarget implements FilterProvider {\n  priority = 3\n  name = 'Values'\n  singularItemName = 'value'\n  value = 'value'\n  type = 'filter' as const\n  manuallyDetermineFilterEligibility = true\n\n  #parsing: typeof Parsing | undefined\n\n  constructor(public queryBuilder: QueryBuilderElement) {\n    super()\n    this.queryBuilder.addEventListener('query', this)\n  }\n\n  async handleEvent(event: QueryEvent) {\n    const state = event.parsedMetadata as ParsedIntermediateRepresentation | undefined\n\n    if (!state) {\n      return []\n    }\n\n    if (\n      state.caretPositionKind !== CaretPositionKind.OtherQualifier &&\n      state.caretPositionKind !== CaretPositionKind.Is\n    ) {\n      return []\n    }\n\n    if (!state.caretSelectedNode || !isQualifier(state.caretSelectedNode)) {\n      return []\n    }\n\n    if (!this.#parsing) {\n      this.#parsing = await import('../parsing/parsing')\n    }\n\n    let matches = []\n\n    const isLicense = state.caretSelectedNode.qualifier === 'License'\n    const isLanguage = state.caretSelectedNode.qualifier === 'Language'\n\n    if (isLicense) {\n      matches = [\n        ['BSD Zero Clause License', '0bsd'],\n        ['MIT License', 'mit'],\n        ['Apache License 2.0', 'apache-2.0'],\n        ['Creative Commons', 'cc'],\n        ['GNU General Public License', 'gpl'],\n        ['GNU Lesser General Public License', 'lgpl'],\n      ]\n    } else {\n      matches = this.#parsing\n        .getPossibleQualifierValues(\n          this.#parsing.chooseSearchType(state.ast as BaseNode, true),\n          state.caretSelectedNode.qualifier,\n        )\n        .map(r => [r, r])\n    }\n\n    let term = state.query\n    if (state.caretSelectedNode && isQualifier(state.caretSelectedNode)) {\n      if (isContentNode(state.caretSelectedNode.content)) {\n        term = state.caretSelectedNode.content.value as string\n      } else {\n        term = ''\n      }\n    }\n\n    if (term.length > 0) {\n      const fuzzyQuery = term.replace(/\\s/g, '')\n      const key = (r: string[]) => {\n        const t = r[0] === r[1] ? r[0]! : `${r[0]} ${r[1]}`\n        const score = fuzzyScore(t, fuzzyQuery)\n        return score > 0 ? {score, text: t} : undefined\n      }\n      matches = filterSort(matches, key, compare)\n    }\n\n    for (const suggestion of matches.slice(0, 5)) {\n      if (state.caretSelectedNode && isQualifier(state.caretSelectedNode)) {\n        let rewriteStart = state.caretSelectedNode.location.end\n        let rewriteEnd = state.caretSelectedNode.location.end\n        if (isContentNode(state.caretSelectedNode.content)) {\n          rewriteStart = state.caretSelectedNode.content.location.start\n          rewriteEnd = state.caretSelectedNode.content.location.end\n        }\n\n        const quotedValue = suggestion[1]!.includes(' ') ? `\"${suggestion[1]}\"` : suggestion[1]!\n\n        const newQuery = `${state.query.slice(0, rewriteStart) + quotedValue} ${state.query.slice(rewriteEnd)}`\n        const action = {\n          replaceQueryWith: newQuery,\n          moveCaretTo: rewriteStart + quotedValue.length + 1,\n        }\n        this.dispatchEvent(\n          new FilterItem({\n            filter: 'owner',\n            value: suggestion[0]!,\n            icon: isLanguage ? Octicon.Circle : undefined,\n            priority: 0,\n            action,\n          }),\n        )\n      }\n    }\n  }\n}\n","import {filterSort} from '@github-ui/filter-sort'\nimport {compare, fuzzyScore} from '@github-ui/fuzzy-filter'\nimport type {QueryEvent, SearchProvider} from '@github-ui/query-builder-element/query-builder-api'\nimport {SearchItem, Octicon} from '@github-ui/query-builder-element/query-builder-api'\nimport type {QueryBuilderElement} from '@github-ui/query-builder-element'\nimport {CaretPositionKind, isContentNode, isQualifier} from '../parsing/common'\nimport type {ParsedIntermediateRepresentation} from '../qbsearch-input-element'\nimport {getSuggestions} from '@github-ui/jump-to-element/model'\n\ninterface Team {\n  name: string\n  path: string\n}\n\nexport class TeamsProvider extends EventTarget implements SearchProvider {\n  priority = 7\n  name = 'Teams'\n  singularItemName = 'team'\n  value = 'team'\n  type = 'search' as const\n  manuallyDetermineFilterEligibility = true\n\n  #suggestedTeams: Team[] | null = null\n  #input: HTMLElement\n\n  constructor(\n    public queryBuilder: QueryBuilderElement,\n    input: HTMLElement,\n  ) {\n    super()\n    this.queryBuilder.addEventListener('query', this)\n    this.#input = input\n  }\n\n  async handleEvent(event: QueryEvent) {\n    const state = event.parsedMetadata as ParsedIntermediateRepresentation | undefined\n    const hasFocus = this.queryBuilder.hasFocus()\n    if (!state || !hasFocus || state.caretPositionKind !== CaretPositionKind.Text) {\n      return []\n    }\n\n    let term = state.query\n    if (state.caretSelectedNode && isQualifier(state.caretSelectedNode)) {\n      if (isContentNode(state.caretSelectedNode.content)) {\n        term = state.caretSelectedNode.content.value as string\n      } else {\n        term = ''\n      }\n    }\n\n    if (this.#suggestedTeams === null) {\n      this.#suggestedTeams = (await getSuggestions(this.#input))\n        .filter(r => r.type === 'Team')\n        .map(r => {\n          return {\n            name: r.name,\n            path: r.path,\n          }\n        })\n    }\n\n    let matches = this.#suggestedTeams.slice(0, 4)\n    if (term.length > 0) {\n      const fuzzyQuery = term.replace(/\\s/g, '')\n      const key = (team: Team) => {\n        const score = fuzzyScore(team.name, fuzzyQuery)\n        return score > 0 ? {score, text: team.name} : null\n      }\n      matches = filterSort(this.#suggestedTeams, key, compare)\n    }\n\n    for (const suggestion of matches.slice(0, 5)) {\n      this.dispatchEvent(\n        new SearchItem({\n          value: suggestion.name,\n          icon: Octicon.Team,\n          priority: 0,\n          action: {\n            url: suggestion.path,\n          },\n        }),\n      )\n    }\n  }\n}\n","import {filterSort} from '@github-ui/filter-sort'\nimport {compare, fuzzyScore} from '@github-ui/fuzzy-filter'\nimport {\n  type QueryEvent,\n  FilterItem,\n  type FilterProvider,\n  Octicon,\n} from '@github-ui/query-builder-element/query-builder-api'\nimport type {QueryBuilderElement} from '@github-ui/query-builder-element'\nimport {getSuggestions} from '@github-ui/jump-to-element/model'\nimport {CaretPositionKind, isContentNode, isQualifier} from '../parsing/common'\nimport type {ParsedIntermediateRepresentation} from '../qbsearch-input-element'\n\ninterface Project {\n  name: string\n  path: string\n}\n\nexport class ProjectsProvider extends EventTarget implements FilterProvider {\n  priority = 8\n  name = 'Projects'\n  singularItemName = 'project'\n  value = 'project'\n  type = 'filter' as const\n  manuallyDetermineFilterEligibility = true\n\n  #suggestedProjects: Project[] | null = null\n  #input: HTMLElement\n\n  constructor(\n    public queryBuilder: QueryBuilderElement,\n    input: HTMLElement,\n  ) {\n    super()\n    this.queryBuilder.addEventListener('query', this)\n    this.#input = input\n  }\n\n  async handleEvent(event: QueryEvent) {\n    const state = event.parsedMetadata as ParsedIntermediateRepresentation | undefined\n    const hasFocus = this.queryBuilder.hasFocus()\n    if (!state || !hasFocus || state.caretPositionKind !== CaretPositionKind.Text) {\n      return []\n    }\n\n    let term = state.query\n    if (state.caretSelectedNode && isQualifier(state.caretSelectedNode)) {\n      if (isContentNode(state.caretSelectedNode.content)) {\n        term = state.caretSelectedNode.content.value as string\n      } else {\n        term = ''\n      }\n    }\n\n    if (this.#suggestedProjects === null) {\n      this.#suggestedProjects = (await getSuggestions(this.#input))\n        .filter(r => r.type === 'Project')\n        .map(r => {\n          return {\n            name: r.name,\n            path: r.path,\n          }\n        })\n    }\n\n    let matches = this.#suggestedProjects.slice(0, 4)\n    if (term.length > 0) {\n      const fuzzyQuery = term.replace(/\\s/g, '')\n      const key = (p: Project) => {\n        const score = fuzzyScore(p.name, fuzzyQuery)\n        return score > 0 ? {score, text: p.name} : null\n      }\n      matches = filterSort(this.#suggestedProjects, key, compare)\n    }\n\n    for (const suggestion of matches.slice(0, 5)) {\n      this.dispatchEvent(\n        new FilterItem({\n          filter: 'project',\n          value: suggestion.name,\n          icon: Octicon.Project,\n          priority: 0,\n          action: {\n            url: suggestion.path,\n          },\n        }),\n      )\n    }\n  }\n}\n","import {BlackbirdPermissionCaches} from '@github-ui/blackbird-warm-caches'\nimport type {QueryEvent, SearchProvider} from '@github-ui/query-builder-element/query-builder-api'\nimport {Octicon, SearchItem, PrefixColor, FetchDataEvent} from '@github-ui/query-builder-element/query-builder-api'\nimport type {QueryBuilderElement} from '@github-ui/query-builder-element'\nimport {CaretPositionKind} from '../parsing/common'\nimport type {ParsedIntermediateRepresentation} from '../qbsearch-input-element'\nimport {SymbolKind} from '@github-ui/code-nav'\nimport {isLoggedIn} from '@github-ui/client-env'\n\ninterface BlackbirdSymbol {\n  fully_qualified_name: string\n  kind: string\n}\n\ninterface BlackbirdSuggestion {\n  kind: string\n  query: string\n  repository_nwo: string\n  language: string\n  path: string\n  repository_id: number\n  commit_sha: string\n  line_number: number\n  symbol: BlackbirdSymbol | null\n}\n\ntype SuggestionsResponse = {\n  suggestions: BlackbirdSuggestion[]\n  queryErrors: []\n  failed: boolean\n}\n\nexport class BlackbirdProvider extends EventTarget implements SearchProvider {\n  priority = 9\n  name = 'Code'\n  singularItemName = 'code'\n  value = 'code'\n  type = 'search' as const\n  manuallyDetermineFilterEligibility = true\n  blackbirdCaches: BlackbirdPermissionCaches = new BlackbirdPermissionCaches()\n\n  #cache: Record<string, BlackbirdSuggestion[]> = {}\n  #input: HTMLElement\n\n  constructor(\n    public queryBuilder: QueryBuilderElement,\n    input: HTMLElement,\n  ) {\n    super()\n    this.queryBuilder.addEventListener('query', this)\n    this.#input = input\n  }\n\n  async handleEvent(event: QueryEvent) {\n    const result = this.fetchData(event)\n    this.dispatchEvent(new FetchDataEvent(result))\n    const suggestions = (await result)!\n\n    let suggestionsEmitted = 0\n    for (const suggestion of suggestions) {\n      if (suggestionsEmitted >= 5) return\n\n      if (suggestion.kind === 'SUGGESTION_KIND_PATH') {\n        if (!suggestion.path) continue\n\n        const trailingSlashPos = suggestion.path.lastIndexOf('/')\n        const filename = suggestion.path.substring(trailingSlashPos + 1)\n        const path = truncatePath(suggestion.path.substring(0, trailingSlashPos + 1))\n\n        // TODO: omit this if the query is scoped to a repo already\n        const repoPrefix = suggestion.repository_nwo\n        const separator = repoPrefix.length > 0 && path.length > 0 ? ' · ' : ''\n        const encodedPath = suggestion.path.split('/').map(encodeURIComponent).join('/')\n\n        this.dispatchEvent(\n          new SearchItem({\n            value: filename,\n            icon: Octicon.FileCode,\n            description: `${repoPrefix}${separator}${path}`,\n            priority: 0,\n            action: {\n              url: `/${suggestion.repository_nwo}/blob/${suggestion.commit_sha}/${encodedPath}#L${suggestion.line_number}`,\n            },\n          }),\n        )\n      } else if (suggestion.kind === 'SUGGESTION_KIND_SYMBOL') {\n        const path = truncatePath(suggestion.path)\n\n        // TODO: omit this if the query is scoped to a repo already\n        const repoPrefix = suggestion.repository_nwo\n        const separator = repoPrefix.length > 0 && path.length > 0 ? ' · ' : ''\n        const encodedPath = suggestion.path.split('/').map(encodeURIComponent).join('/')\n        const kind = new SymbolKind({kind: suggestion.symbol?.kind ?? ''})\n\n        this.dispatchEvent(\n          new SearchItem({\n            value: suggestion.symbol?.fully_qualified_name ?? '',\n            prefixText: kind.fullName,\n            prefixColor: prefixColorForSymbolKind(kind),\n            icon: Octicon.FileCode,\n            description: `${repoPrefix}${separator}${path}`,\n            priority: 0,\n            action: {\n              url: `/${suggestion.repository_nwo}/blob/${suggestion.commit_sha}/${encodedPath}#L${suggestion.line_number}`,\n            },\n          }),\n        )\n      } else {\n        // Unsupported suggestion type, skip\n        continue\n      }\n      suggestionsEmitted++\n    }\n  }\n\n  async fetchData(event: QueryEvent) {\n    const state = event.parsedMetadata as ParsedIntermediateRepresentation | undefined\n\n    if (!state || !state.query) {\n      return []\n    }\n\n    if (state.caretPositionKind !== CaretPositionKind.Text && state.caretPositionKind !== CaretPositionKind.Path) {\n      return []\n    }\n\n    if (this.#cache[state.query]) {\n      return this.#cache[state.query]\n    }\n\n    if (isLoggedIn() === false) {\n      return []\n    }\n\n    const urlParams = new URLSearchParams({query: state.query, saved_searches: JSON.stringify(state.customScopes)})\n    const url = this.#input.getAttribute('data-blackbird-suggestions-path')\n    if (!url) throw new Error('could not get blackbird suggestions path')\n\n    await this.blackbirdCaches.setupWarmCachesLoop()\n\n    const response = (await (\n      await fetch(`${url}?${urlParams}`, {\n        method: 'GET',\n        mode: 'same-origin',\n        headers: {\n          Accept: 'application/json',\n        },\n      })\n    ).json()) as SuggestionsResponse\n\n    if (response.failed) {\n      return []\n    }\n\n    // Store the cached response\n    this.#cache[state.query] = response.suggestions\n\n    return response.suggestions\n  }\n}\n\nfunction prefixColorForSymbolKind(kind: SymbolKind): PrefixColor {\n  switch (kind.plColor) {\n    case 'prettylights.syntax.entity':\n      return PrefixColor.Entity\n    case 'prettylights.syntax.constant':\n      return PrefixColor.Constant\n    case 'prettylights.syntax.keyword':\n      return PrefixColor.Keyword\n    case 'prettylights.syntax.variable':\n      return PrefixColor.Variable\n    case 'prettylights.syntax.string':\n      return PrefixColor.String\n    default:\n      return PrefixColor.Entity\n  }\n}\n\nfunction truncatePath(path: string) {\n  if (path.length > 60) {\n    return `...${path.substring(path.length - 60 + 3)}`\n  }\n\n  return path\n}\n","import type {QueryEvent, SearchProvider, SearchScopeText} from '@github-ui/query-builder-element/query-builder-api'\nimport {Octicon, SearchItem} from '@github-ui/query-builder-element/query-builder-api'\nimport type {QueryBuilderElement} from '@github-ui/query-builder-element'\nimport type {ParsedIntermediateRepresentation} from '../qbsearch-input-element'\nimport type {QualifierNode, NodeWithChildren, ContentNode} from '@github/blackbird-parser'\nimport {CaretPositionKind, extractRepoOrgScopes, hasChildren, isQualifier} from '../parsing/common'\n// eslint-disable-next-line import/no-namespace\nimport type * as Parsing from '../parsing/parsing'\n\nexport class InputProvider extends EventTarget implements SearchProvider {\n  priority = 0\n  name = ''\n  singularItemName = 'search'\n  value = 'search'\n  type = 'search' as const\n  copilotChatEnabled: boolean = false\n  #input: HTMLElement\n  #parser: typeof Parsing | undefined\n\n  constructor(\n    public queryBuilder: QueryBuilderElement,\n    input: HTMLElement,\n  ) {\n    super()\n    this.queryBuilder.addEventListener('query', this)\n    this.#input = input\n  }\n\n  async handleEvent(event: QueryEvent) {\n    const state = event.parsedMetadata as ParsedIntermediateRepresentation | undefined\n\n    if (event.rawQuery) {\n      // Always emit a fallback suggestion, if no other suggestions exist\n      this.dispatchEvent(\n        new SearchItem({\n          value: event.rawQuery,\n          scope: 'GITHUB',\n          icon: Octicon.Search,\n          priority: 0,\n          action: {\n            query: event.rawQuery,\n          },\n          isFallbackSuggestion: true,\n        }),\n      )\n    }\n\n    if (!state || state.caretPositionKind !== CaretPositionKind.Text) {\n      return []\n    }\n\n    let trimmedQuery = state.query.trim()\n\n    let repo = this.#input.getAttribute('data-current-repository')\n    let org = this.#input.getAttribute('data-current-org')\n    let orgNode: QualifierNode | undefined = undefined\n    let user = this.#input.getAttribute('data-current-owner')\n\n    if (!this.#parser) {\n      this.#parser = await import('../parsing/parsing')\n    }\n\n    // Use query to extract the current qualifier for suggestions\n    const astNode: NodeWithChildren = this.#parser.parseString(trimmedQuery || '') as NodeWithChildren\n\n    // No qualifiers found\n    if (astNode.children) {\n      const qualifierNodes = astNode.children.filter(node => node.kind === 'Qualifier')\n      repo = (qualifierNodes.find(node => node.qualifier === 'Repo')?.content as ContentNode)?.value?.toString() || repo\n      orgNode = qualifierNodes.find(node => node.qualifier === 'Org')\n      org = (orgNode?.content as ContentNode)?.value?.toString() || org\n      user =\n        (\n          qualifierNodes.find(node => node.qualifier === 'Org' && node.raw === 'user:')?.content as ContentNode\n        )?.value?.toString() || user\n      // Get owner from nwo\n      if (repo && !orgNode) {\n        org = repo.split('/')[0]!\n      }\n    }\n\n    interface Suggestion {\n      query: string\n      scope?: keyof typeof SearchScopeText\n    }\n    const suggestions: Suggestion[] = []\n    let containsScopes = false\n\n    if (state.ast) {\n      const node = state.ast\n\n      // check if node has query text attached to it (not just qualifier)\n      if (hasChildren(node)) {\n        trimmedQuery = node.children\n          .filter(item => item.kind === 'Text')\n          .map(item => item.value)\n          .join(' ')\n\n        const scopes = extractRepoOrgScopes(node)\n        // If the scopes contains a saved scope, don't generate input suggestions,\n        // since we can't generate sensible parent scopes.\n        if (scopes.find(s => s.kind === 'saved')) {\n          return []\n        }\n\n        // If text has a repo or org qualifier within it, show just query text at the bottom of input\n        if (scopes.length) {\n          containsScopes = true\n        }\n      } else if (isQualifier(node)) {\n        // if node is only a qualifier, don't include it as part of query text\n        trimmedQuery = ''\n      }\n\n      if (repo && repo.length > 0) {\n        suggestions.push({\n          query: `repo:${repo} ${trimmedQuery}`,\n          scope: 'REPO',\n        })\n      }\n      if (orgNode) {\n        suggestions.push({\n          query: `${orgNode.raw}${org} ${trimmedQuery}`,\n          scope: 'ORG',\n        })\n      } else {\n        if (org && org.length > 0) {\n          suggestions.push({\n            query: `org:${org} ${trimmedQuery}`,\n            scope: 'ORG',\n          })\n        }\n        if (user && user.length > 0) {\n          suggestions.push({\n            query: `user:${user} ${trimmedQuery}`,\n            scope: 'OWNER',\n          })\n        }\n      }\n    }\n\n    if (trimmedQuery.length > 0) {\n      if (!containsScopes) {\n        suggestions.unshift({\n          query: trimmedQuery,\n          scope: 'GITHUB',\n        })\n      } else {\n        suggestions.push({query: trimmedQuery, scope: 'GITHUB'})\n      }\n    }\n\n    // If we are currently on a non-root tree view page, offer to search within\n    // the current directory.\n    const path = getPathQualifier(window.location.pathname)\n    if (path) {\n      const query = `repo:${repo} path:${path} ${trimmedQuery}`\n      this.dispatchEvent(\n        new SearchItem({\n          value: query,\n          scope: 'DIRECTORY',\n          icon: Octicon.Search,\n          priority: 0,\n          action: {\n            commandName: 'blackbird-monolith.search',\n            data: {\n              query,\n            },\n          },\n        }),\n      )\n    }\n\n    for (const suggestion of suggestions.slice(0, 3)) {\n      this.dispatchEvent(\n        new SearchItem({\n          value: suggestion.query,\n          scope: suggestion.scope,\n          icon: Octicon.Search,\n          priority: 0,\n          action: {\n            commandName: 'blackbird-monolith.search',\n            data: {\n              query: suggestion.query,\n            },\n          },\n        }),\n      )\n    }\n  }\n\n  getQualifierType(input: string): string {\n    if (input.includes('repo')) {\n      // eslint-disable-next-line i18n-text/no-en\n      return 'In this repository'\n    } else if (input.includes('org')) {\n      // eslint-disable-next-line i18n-text/no-en\n      return 'In this organization'\n    } else if (input.includes('user')) {\n      // eslint-disable-next-line i18n-text/no-en\n      return 'In this user'\n    } else if (input.includes('owner')) {\n      // eslint-disable-next-line i18n-text/no-en\n      return 'In this owner'\n    } else {\n      // eslint-disable-next-line i18n-text/no-en\n      return 'All of GitHub'\n    }\n  }\n}\n\nfunction buildRegexQuery(path: string): string {\n  // Decode any URL characters\n  path = decodeURIComponent(path)\n\n  // Strip trailing slash\n  if (path.endsWith('/')) {\n    path = path.substring(0, path.length - 1)\n  }\n\n  // Escape regex chars\n  const escaped = path.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&')\n\n  // Build path regex query\n  return `/^${escaped.replaceAll('/', '\\\\/')}\\\\//`\n}\n\nexport function getPathQualifier(pathname: string): string | undefined {\n  const treeRegex = /^\\/[^/]+\\/[^/]+\\/tree\\/[^/]+\\/(.*)/\n\n  const m = treeRegex.exec(pathname)\n  if (m) {\n    for (let i = 1; i < m.length; i++) {\n      if (m[i]) {\n        return buildRegexQuery(m[i]!)\n      }\n    }\n  }\n\n  return undefined\n}\n","// Temporary file to hold the ExplorePage type and the initial and full list of ExplorePages.\n// The list is hardcoded for now as we experiment with the Explore search provider.\n\nexport interface ExplorePage {\n  title: string\n  url: string\n  octicon: string\n}\n\n// Initial suggestions are: Enterprise, Security, Copilot, and Pricing - before the user types anything.\nexport const InitialExplorePages: ExplorePage[] = [\n  {title: 'Enterprise', url: '/enterprise', octicon: 'organization'},\n  {title: 'Security', url: '/security', octicon: 'shield-check'},\n  {title: 'Copilot', url: '/features/copilot', octicon: 'copilot'},\n  {title: 'Pricing', url: '/pricing', octicon: 'credit-card'},\n]\n\nexport const ExplorePages: ExplorePage[] = [\n  {title: 'GitHub Actions', url: '/features/actions', octicon: 'workflow'},\n  {title: 'Blog', url: 'https://github.blog', octicon: 'book'},\n  {title: 'CI/CD', url: '/solutions/ci-cd/', octicon: 'workflow'},\n  {title: 'Code review', url: '/features/code-review', octicon: 'code-review'},\n  {title: 'Codespaces', url: '/features/codespaces', octicon: 'codespaces'},\n  {title: 'Copilot', url: '/features/copilot', octicon: 'copilot'},\n  {title: 'Customer stories', url: '/customer-stories', octicon: 'comment'},\n  {title: 'Discussions', url: '/features/discussions', octicon: 'comment-discussion'},\n  {title: 'Documentation', url: 'https://docs.github.com', octicon: 'book'},\n  {title: 'Enterprise', url: '/enterprise', octicon: 'organization'},\n  {title: 'Features', url: '/features', octicon: 'rocket'},\n  {title: 'GitHub Security', url: '/security', octicon: 'shield-check'},\n  {title: 'GitHub Sponsors', url: '/sponsors', octicon: 'heart'},\n  {title: 'GitHub Pages', url: 'https://pages.github.com', octicon: 'server'},\n  {title: 'Integrations', url: '/features/integrations', octicon: 'globe'},\n  {title: 'Issues', url: '/features/issues', octicon: 'issue-opened'},\n  {title: 'GitHub Mobile', url: '/mobile', octicon: 'device-mobile'},\n  {title: 'GitHub Packages', url: '/features/packages', octicon: 'package'},\n  {title: 'Pricing', url: '/pricing', octicon: 'credit-card'},\n  {title: 'Resources', url: 'https://resources.github.com', octicon: 'book'},\n  {title: 'Secure your code', url: '/features/security/code-scanning', octicon: 'shield-check'},\n  {title: 'Security features', url: '/features/security', octicon: 'shield-check'},\n  {title: 'Software supply chain', url: '/features/security/software-supply-chain', octicon: 'shield-check'},\n  {title: 'Startups', url: '/enterprise/startups', octicon: 'rocket'},\n  {title: 'Team', url: '/team', octicon: 'organization'},\n  {title: 'The ReadME Project', url: '/readme', octicon: 'book'},\n  {title: 'The ReadME Podcast', url: '/readme/podcast', octicon: 'play'},\n  {title: 'Feature Previews', url: '/features/preview', octicon: 'gift'},\n  {title: 'Code Search', url: '/features/code-search', octicon: 'code-square'},\n  {title: 'GitHub Changelog', url: 'https://github.blog/changelog', octicon: 'book'},\n  {title: 'GitHub Shop', url: 'https://www.thegithubshop.com/', octicon: 'gift'},\n  {title: 'GitHub Desktop', url: 'https://desktop.github.com', octicon: 'device-desktop'},\n]\n","import {filterSort} from '@github-ui/filter-sort'\nimport {compare, fuzzyScore} from '@github-ui/fuzzy-filter'\nimport type {QueryEvent, SearchProvider, Octicon} from '@github-ui/query-builder-element/query-builder-api'\nimport {FetchDataEvent, SearchItem} from '@github-ui/query-builder-element/query-builder-api'\nimport type {QueryBuilderElement} from '@github-ui/query-builder-element'\nimport {isContentNode, isQualifier} from '../parsing/common'\nimport type {ParsedIntermediateRepresentation} from '../qbsearch-input-element'\nimport {ExplorePages, InitialExplorePages} from '../suggestions/explore-pages'\n\ninterface ExplorePage {\n  title: string\n  url: string\n  octicon: Octicon | string\n}\n\nconst resultsPriority = 11 // The priority of the explore search provider, higher numbers appear at the bottom of the results\n\nexport class ExploreProvider extends EventTarget implements SearchProvider {\n  priority = resultsPriority\n  name = 'Explore'\n  singularItemName = 'explore page'\n  value = 'explore'\n  type = 'search' as const\n  manuallyDetermineFilterEligibility = true\n\n  #querySuggestions: ExplorePage[] | null = null\n  #defaultSuggestions: ExplorePage[] | null = null\n\n  constructor(public queryBuilder: QueryBuilderElement) {\n    super()\n    this.queryBuilder.addEventListener('query', this)\n  }\n\n  // For experimental / testing, we will get the explore pages from a hardcoded list from now.\n  #fetchQuerySuggestions() {\n    const data = Promise.resolve(ExplorePages)\n    this.dispatchEvent(new FetchDataEvent(data))\n    return data\n  }\n\n  #fetchDefaultSuggestions() {\n    const data = Promise.resolve(InitialExplorePages)\n    this.dispatchEvent(new FetchDataEvent(data))\n    return data\n  }\n\n  async #addDefaultSuggestions() {\n    this.#defaultSuggestions = await this.#fetchDefaultSuggestions()\n    for (const page of this.#defaultSuggestions) {\n      this.dispatchEvent(\n        new SearchItem({\n          value: page.title,\n          icon: page.octicon as Octicon,\n          priority: resultsPriority,\n          scope: 'EXPLORE',\n          action: {\n            url: `${page.url}?ref_loc=search`,\n          },\n        }),\n      )\n    }\n  }\n\n  async handleEvent(event: QueryEvent) {\n    const path = window.location.pathname\n    const isHomePagePath = path === '/' || path === '/home'\n    const isMarketingPagePath = ExplorePages.some(page => page.url.startsWith('/') && path.startsWith(page.url))\n\n    if (!isHomePagePath && !isMarketingPagePath) {\n      // We only want to show suggestions on the homepage and marketing pages\n      return []\n    }\n\n    const state = event.parsedMetadata as ParsedIntermediateRepresentation | undefined\n    if (!state?.query) {\n      await this.#addDefaultSuggestions()\n      return []\n    }\n\n    if (this.#querySuggestions === null) {\n      this.#querySuggestions = await this.#fetchQuerySuggestions()\n    }\n\n    // make sure we only suggest for terms that are user typed content (number, text etc.)\n    let term = state?.query\n    if (state?.caretSelectedNode && isQualifier(state?.caretSelectedNode)) {\n      if (isContentNode(state.caretSelectedNode.content)) {\n        term = state.caretSelectedNode.content.value as string\n      } else {\n        term = ''\n      }\n    }\n\n    let matches = this.#querySuggestions\n    if (term && term.length > 0) {\n      const fuzzyQuery = term.replace(/\\s/g, '')\n      const key = (page: ExplorePage) => {\n        const score = fuzzyScore(page.title, fuzzyQuery)\n        return score > 0 ? {score, text: page.title} : null\n      }\n      matches = filterSort(this.#querySuggestions, key, compare)\n    }\n\n    for (const page of matches.slice(0, 5)) {\n      this.dispatchEvent(\n        new SearchItem({\n          value: page.title,\n          icon: page.octicon as Octicon,\n          priority: resultsPriority,\n          scope: 'EXPLORE',\n          action: {\n            url: `${page.url}?q=${term}&ref_loc=search`,\n          },\n        }),\n      )\n    }\n  }\n}\n","import {\n  Octicon,\n  SearchItem,\n  type QueryBuilderElement,\n  type QueryEvent,\n  type SearchProvider,\n} from '@github-ui/query-builder-element'\nimport type {ParsedIntermediateRepresentation, QbsearchInputElement} from '../qbsearch-input-element'\nimport type {SafeHTMLString} from '@github-ui/safe-html'\nimport {debounce} from '@github/mini-throttle'\nimport {verifiedFetchJSON} from '@github-ui/verified-fetch'\nimport {CopilotAuthTokenProvider} from '@github-ui/copilot-auth-token'\nimport {CaretPositionKind} from '../parsing/common'\n\nconst DEFAULT_NL_SEARCH_QUERY = 'is:issue is:open assignee:@me'\n\nexport class CopilotProvider extends EventTarget implements SearchProvider {\n  priority = 10\n  name = 'Copilot'\n  singularItemName = 'copilot'\n  value = 'copilot'\n  type = 'search' as const\n  #copilotChatEnabled: boolean = false\n  #naturalLanugageSearchEnabled: boolean = false\n  #input: QbsearchInputElement\n  #repo: string | null\n  #nlSearchToken: string | null\n  #abortController: AbortController = new AbortController()\n  #copilotAuthTokenProvider: CopilotAuthTokenProvider\n\n  constructor(\n    public queryBuilder: QueryBuilderElement,\n    input: QbsearchInputElement,\n  ) {\n    super()\n    this.queryBuilder.addEventListener('query', this)\n    this.#input = input\n    this.#repo = this.#input.getAttribute('data-current-repository')\n    this.#copilotChatEnabled = this.#input.getAttribute('data-copilot-chat-enabled') === 'true'\n    this.#naturalLanugageSearchEnabled = this.#input.getAttribute('data-nl-search-enabled') === 'true'\n    this.#nlSearchToken = this.#input.getAttribute('data-nl-search-csrf')\n    this.#copilotAuthTokenProvider = new CopilotAuthTokenProvider([])\n  }\n\n  fetchIndexStatusPromise(repo: string, token: string) {\n    const fetchUrl = new URL(`/search/check_indexing_status?nwo=${encodeURIComponent(repo)}`, window.location.origin)\n    const indexedResponse = fetch(fetchUrl.href, {\n      method: 'GET',\n      mode: 'same-origin',\n      headers: {\n        Accept: 'application/json',\n        'Scoped-CSRF-Token': token,\n        'X-Requested-With': 'XMLHttpRequest',\n      },\n    })\n\n    return indexedResponse\n  }\n\n  primerSpinner() {\n    return {\n      // eslint-disable-next-line github/unescaped-html-literal\n      html: `<svg style=\"box-sizing: content-box; color: var(--color-icon-primary); fill: none\" width=\"16\" height=\"16\" viewBox=\"0 0 16 16\" class=\"anim-rotate\">\n  <circle cx=\"8\" cy=\"8\" r=\"7\" stroke=\"currentColor\" stroke-opacity=\"0.25\" stroke-width=\"2\" vector-effect=\"non-scaling-stroke\" fill=\"none\"></circle>\n  <path d=\"M15 8a7.002 7.002 0 00-7-7\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" vector-effect=\"non-scaling-stroke\"></path>\n</svg>` as SafeHTMLString,\n    }\n  }\n\n  async handleEvent(event: QueryEvent) {\n    if (!this.#copilotChatEnabled) return\n    const state = event.parsedMetadata as ParsedIntermediateRepresentation | undefined\n    if (!state || state.caretPositionKind !== CaretPositionKind.Text) return\n\n    const trimmedQuery = state?.query.trim() ?? ''\n\n    this.dispatchEvent(\n      new SearchItem({\n        value: `Ask Copilot`,\n        scope: 'COPILOT_CHAT',\n        icon: Octicon.Copilot,\n        priority: 0,\n        action: {\n          commandName: 'search-copilot-chat',\n          data: {\n            content: trimmedQuery,\n            repoNwo: this.#repo,\n          },\n        },\n      }),\n    )\n\n    if (!this.#naturalLanugageSearchEnabled) return\n    if (!trimmedQuery) {\n      this.dispatchEvent(\n        new SearchItem({\n          id: 'copilot-nl-search',\n          value: DEFAULT_NL_SEARCH_QUERY,\n          scope: 'COPILOT_SEARCH',\n          icon: Octicon.Copilot,\n          priority: 0,\n          action: {\n            commandName: 'convert-to-query-syntax',\n            data: {\n              content: DEFAULT_NL_SEARCH_QUERY,\n            },\n          },\n        }),\n      )\n    } else {\n      this.dispatchEvent(\n        new SearchItem({\n          id: 'copilot-nl-search',\n          value: trimmedQuery,\n          scope: 'COPILOT_SEARCH',\n          icon: trimmedQuery === DEFAULT_NL_SEARCH_QUERY ? Octicon.Copilot : this.primerSpinner(),\n          priority: 0,\n          action: {\n            commandName: 'no-op',\n            data: {},\n          },\n        }),\n      )\n    }\n    this.queryCopilotSearchDebounced(event)\n  }\n\n  queryCopilotSearch = async (event: QueryEvent) => {\n    const state = event.parsedMetadata as ParsedIntermediateRepresentation | undefined\n    const trimmedQuery = state?.query.trim() ?? ''\n\n    if (!this.#nlSearchToken || !trimmedQuery || trimmedQuery === DEFAULT_NL_SEARCH_QUERY) return\n\n    try {\n      const token = await this.#copilotAuthTokenProvider.getAuthToken()\n      this.#abortController.abort()\n      this.#abortController = new AbortController()\n\n      const response = await verifiedFetchJSON('/copilot/completions/nl-search', {\n        method: 'POST',\n        body: {query: trimmedQuery},\n        headers: {\n          'Scoped-CSRF-Token': this.#nlSearchToken,\n          'X-Copilot-Api-Token': token.value,\n        },\n        signal: this.#abortController.signal,\n      })\n\n      if (!response.ok) {\n        return this.dispatchEvent(\n          new SearchItem({\n            isUpdate: true,\n            id: 'copilot-nl-search',\n            value: 'There was an error parsing your query',\n            scope: 'COPILOT_SEARCH',\n            icon: Octicon.CopilotError,\n            priority: 0,\n            action: {\n              commandName: 'no-op',\n              data: {},\n            },\n          }),\n        )\n      }\n\n      const result: {query: string} = await response.json()\n      if (trimmedQuery.length > 0 && this.#naturalLanugageSearchEnabled) {\n        this.dispatchEvent(\n          new SearchItem({\n            isUpdate: true,\n            id: 'copilot-nl-search',\n            value: result.query || trimmedQuery,\n            scope: 'COPILOT_SEARCH',\n            icon: Octicon.Copilot,\n            priority: 0,\n            action: {\n              commandName: 'convert-to-query-syntax',\n              data: {\n                content: result.query || trimmedQuery,\n              },\n            },\n          }),\n        )\n      }\n    } catch (e) {\n      if (e instanceof Error && e.name === 'AbortError') return\n      this.dispatchEvent(\n        new SearchItem({\n          isUpdate: true,\n          id: 'copilot-nl-search',\n          value: 'There was an error parsing your query',\n          scope: 'COPILOT_SEARCH',\n          icon: Octicon.CopilotError,\n          priority: 0,\n          action: {\n            commandName: 'no-op',\n            data: {},\n          },\n        }),\n      )\n      return\n    }\n  }\n  readonly queryCopilotSearchDebounced = debounce(this.queryCopilotSearch, 1000)\n}\n","import '@github/details-menu-element'\nimport {attr, controller, target} from '@github/catalyst'\nimport {CaretPositionKind, shouldRedirectInsteadOfSearch} from './parsing/common'\n// `import type` so that we don't bring the parser code in on every page load\nimport type {BaseNode, FinalNode, NothingNode} from '@github/blackbird-parser'\nimport type {SuggestionInputState, CustomScope} from './suggestions/types'\nimport {logPageView} from '@github-ui/jump-to-element/page-views'\nimport type {ModalDialogElement} from '@primer/view-components/app/components/primer/alpha/modal_dialog'\nimport {sendEvent} from '@github-ui/hydro-analytics'\nimport {softNavigate} from '@github-ui/soft-navigate'\nimport {BlackbirdPermissionCaches} from '@github-ui/blackbird-warm-caches'\nimport {getBlackbirdExperiments} from './experiments'\nimport type {QueryBuilderElement, Provider} from '@github-ui/query-builder-element'\nimport {parseFileAnchor} from '../../assets/modules/github/blob-anchor'\nimport {\n  type QueryElement,\n  type QueryTextElement,\n  type Parser,\n  TextElementStyle,\n} from '@github-ui/query-builder-element/query-builder-api'\n\nimport {HistoryProvider} from './providers/history'\nimport {LanguagesProvider} from './providers/languages'\nimport {ReposFilterProvider, ReposSearchProvider} from './providers/repos'\nimport {SavedScopeProvider} from './providers/saved'\nimport {OwnersProvider} from './providers/owners'\nimport {FixedValuesProvider} from './providers/fixed'\nimport {TeamsProvider} from './providers/teams'\nimport {ProjectsProvider} from './providers/projects'\nimport {BlackbirdProvider} from './providers/blackbird'\nimport {InputProvider} from './providers/input'\nimport {isFeatureEnabled} from '@github-ui/feature-flags'\nimport {isLoggedIn} from '@github-ui/client-env'\nimport type {CustomScopesElement} from './custom-scopes-element'\n// eslint-disable-next-line import/no-namespace\nimport type * as Parsing from './parsing/parsing'\nimport {ExploreProvider} from './providers/explore'\nimport {CopilotProvider} from './providers/copilot'\n/** minimum number of milliseconds between parsing input */\nconst parseDelay = 15\nconst nonBreakingSpace = String.fromCharCode(160)\n\nconst MAX_LOCAL_HISTORY = 50\n\n// eslint-disable-next-line i18n-text/no-en\nconst PLACEHOLDER_SAFE_HTML = 'Type <kbd class=\"AppHeader-search-kbd\">/</kbd> to search'\n\nconst marketing_pages_search_explore_provider_enabled = isFeatureEnabled('marketing_pages_search_explore_provider')\n\nexport interface ParsedIntermediateRepresentation {\n  ast?: FinalNode\n  query: string\n  caretPositionKind?: CaretPositionKind\n  caretSelectedNode?: BaseNode\n  customScopes?: CustomScope[]\n}\n\n@controller\nexport class QbsearchInputElement extends HTMLElement {\n  @target inputButton: HTMLButtonElement\n  @target inputButtonText: HTMLSpanElement\n  @target queryBuilder: QueryBuilderElement\n  @target queryBuilderContainer: HTMLDivElement\n\n  @target clearInputButton: HTMLButtonElement\n  @target clearInputButtonSeparator: HTMLDivElement\n\n  @target searchSuggestionsDialog: ModalDialogElement\n  @target suggestionHeadingTemplate: HTMLTemplateElement\n  @target suggestionTemplate: HTMLTemplateElement\n  @target darkBackdrop: HTMLDivElement\n\n  @target customScopesManager: CustomScopesElement\n\n  @target feedbackDialog: ModalDialogElement\n\n  @attr headerRedesignEnabled = false\n\n  #isReactContext: boolean\n  #eventAbortController: AbortController | undefined\n  private blackbirdCaches: BlackbirdPermissionCaches = new BlackbirdPermissionCaches()\n  #globalNavAlwaysHidden = false\n  private lastParsedQuery: string | null\n  private ast: FinalNode | undefined\n  #caretPositionKind: CaretPositionKind = CaretPositionKind.Text\n  #caretSelectedNode: BaseNode | undefined\n  // the parsing module is loaded asynchronously\n  private parsing: typeof Parsing | undefined\n  private parsingPromise: Promise<typeof Parsing> | undefined\n  #customScopesSuggestionProvider: SavedScopeProvider\n  #dialogFocusReturn: HTMLElement | undefined\n  #returnFocusElement: HTMLElement | null = null\n  #customScopesUrlPath: string\n  #customScopeManagerInitialized = false\n\n  parser: Parser<ParsedIntermediateRepresentation> = {\n    parse: (query: string, caretPosition: number | undefined) => {\n      if (!this.parsing) {\n        // if there is no query, we don't need to load the parser and parse\n        // but if we are expanded we should go ahead and get it ready\n        if (query || this.classList.contains('expanded')) {\n          ;(async () => {\n            await this.loadParser()\n            // Trigger re-parse when parser is available\n            this.queryBuilder.parseQuery()\n          })()\n        }\n        return {\n          query,\n        }\n      }\n      const [ast] = this.parsing.parseSearchInput(query)\n      const customScopes = this.#findCustomScopesNeededForSearch(ast)\n\n      // If a caret position is specified, calculate caret position metadata\n      let caretPositionKind = undefined\n      let caretSelectedNode = undefined\n      if (caretPosition !== undefined) {\n        const caretData = this.parsing.getCaretPositionKindFromIndex(ast, caretPosition)\n        caretPositionKind = caretData.kind\n        caretSelectedNode = caretData.node\n      }\n\n      return {\n        ast,\n        query,\n        caretPositionKind,\n        caretSelectedNode,\n        customScopes,\n      }\n    },\n    flatten: this.flattenASTForQueryBuilder.bind(this),\n  }\n\n  get placeholderText() {\n    return PLACEHOLDER_SAFE_HTML\n  }\n\n  get query() {\n    return this.queryBuilder.input?.value || ''\n  }\n\n  set query(v: string) {\n    // input can be undefined if the query builder has not been upgraded.\n    // it's ok to ignore this because we will update query in the whenDefined handler\n    if (this.queryBuilder.input) {\n      this.queryBuilder.input.value = v\n      this.queryBuilder.parseQuery()\n      this.setButtonText(v)\n      ;(async () => {\n        await this.parseSearchInputRaw()\n        this.syncRichButtonText()\n      })()\n    }\n  }\n\n  flattenASTForQueryBuilder(ir: ParsedIntermediateRepresentation): QueryElement[] {\n    const highlights = this.parsing?.getHighlights(ir.ast as BaseNode) || []\n    highlights.sort((a, b) => a.location.start - b.location.start)\n    let pos = 0\n    const output: QueryTextElement[] = []\n    for (const highlight of highlights) {\n      if (highlight.location.start > pos) {\n        output.push({\n          type: 'text',\n          value: ir.query.substring(pos, highlight.location.start),\n        })\n      }\n\n      if (pos > highlight.location.start) {\n        continue\n      }\n\n      let style = TextElementStyle.Normal\n      if (highlight.className === 'pl-en') {\n        style = TextElementStyle.Entity\n      } else if (highlight.className === 'pl-c1') {\n        style = TextElementStyle.Constant\n      } else if (highlight.className === 'input-parsed-symbol') {\n        style = TextElementStyle.FilterValue\n      }\n\n      output.push({\n        type: 'text',\n        value: ir.query.substring(highlight.location.start, highlight.location.end),\n        style,\n      })\n\n      pos = highlight.location.end\n    }\n\n    if (pos < ir.query.length) {\n      output.push({\n        type: 'text',\n        value: ir.query.substring(pos),\n      })\n    }\n\n    return output\n  }\n\n  isRetainScrollPosition(): boolean {\n    return this.getAttribute('data-retain-scroll-position') === 'true'\n  }\n\n  copilotChatEnabled(): boolean {\n    return this.getAttribute('data-copilot-chat-enabled') === 'true'\n  }\n\n  connectedCallback(): void {\n    this.#isReactContext = false\n    if (isLoggedIn()) {\n      this.#customScopesUrlPath = this.getAttribute('data-custom-scopes-path') || ''\n      this.#customScopesSuggestionProvider = new SavedScopeProvider(this.queryBuilder, this.#customScopesUrlPath)\n      // Initialize custom scopes manager when it is loaded\n      ;(async () => {\n        await window.customElements.whenDefined('custom-scopes')\n        this.customScopesManager.initialize(\n          this.#customScopesSuggestionProvider.customScopesCache,\n          () => {\n            return this.#customScopesSuggestionProvider.fetchSuggestions()\n          },\n          this.#customScopesUrlPath,\n          this.getAttribute('data-delete-custom-scopes-csrf') || '',\n        )\n\n        this.#customScopeManagerInitialized = true\n      })()\n    }\n    // listen for react startup\n    const {signal} = (this.#eventAbortController = new AbortController())\n    window.addEventListener(\n      'blackbird_monolith_react_connected',\n      () => {\n        this.#isReactContext = true\n      },\n      {signal},\n    )\n\n    // Listen for when react disconnects. This can happen e.g. during a Turbo page navigation,\n    // where React is lost, but the search input isn't refreshed!\n    window.addEventListener(\n      'blackbird_monolith_react_disconnected',\n      () => {\n        this.#isReactContext = false\n      },\n      {signal},\n    )\n\n    window.addEventListener(\n      'blackbird_provide_feedback',\n      () => {\n        if (this.feedbackDialog instanceof HTMLDialogElement) {\n          this.feedbackDialog.showModal()\n        } else {\n          this.feedbackDialog.show()\n        }\n      },\n      {signal},\n    )\n\n    window.addEventListener(\n      'blackbird_monolith_set_global_nav_visibility',\n      event => {\n        const globalNavVisibility = (event as CustomEvent).detail\n        this.setGlobalNavVisibility(globalNavVisibility)\n        this.setGlobalBarAlwaysExpanded(!globalNavVisibility)\n\n        this.#globalNavAlwaysHidden = !globalNavVisibility\n\n        if (this.#globalNavAlwaysHidden) {\n          this.classList.add('flex-1')\n        } else {\n          this.classList.remove('flex-1')\n        }\n\n        this.setButtonText(this.query)\n      },\n      {signal},\n    )\n\n    // In case react loaded before we did, emit request to re-transmit react startup\n    window.dispatchEvent(new CustomEvent('blackbird_monolith_retransmit_react'))\n\n    window.addEventListener(\n      'blackbird_monolith_update_input',\n      event => {\n        this.query = (event as CustomEvent).detail\n      },\n      {signal},\n    )\n\n    window.addEventListener(\n      'blackbird_monolith_append_and_focus_input',\n      async event => {\n        const {\n          appendQuery,\n          retainScrollPosition,\n          returnTarget,\n        }: {appendQuery?: string; retainScrollPosition?: boolean; returnTarget?: HTMLElement} = (event as CustomEvent)\n          .detail\n\n        if (returnTarget && retainScrollPosition) {\n          this.expandAndRetainScrollPosition(returnTarget)\n        } else {\n          await this.expand(this.isRetainScrollPosition())\n          if (returnTarget) {\n            this.#returnFocusElement = returnTarget\n          }\n        }\n\n        if (appendQuery && !this.query.trim().endsWith(appendQuery)) {\n          this.query += ` ${appendQuery}`\n        }\n        if (!this.parsing) {\n          await this.loadParser()\n        }\n        this.moveCaretToEndOfInput()\n        await this.parseSearchInputRaw()\n      },\n      {signal},\n    )\n\n    window.addEventListener(\n      'blackbird_monolith_save_query_as_custom_scope',\n      event => {\n        this.saveQueryAsCustomScope(event as CustomEvent<HTMLElement>)\n      },\n      {signal},\n    )\n    ;(async () => {\n      await window.customElements.whenDefined('query-builder')\n\n      const loggedInProviders: Provider[] = [\n        new HistoryProvider(this.queryBuilder),\n        new SavedScopeProvider(this.queryBuilder, this.#customScopesUrlPath),\n        new BlackbirdProvider(this.queryBuilder, this),\n        new CopilotProvider(this.queryBuilder, this),\n      ]\n\n      const loggedOutProviders: Provider[] = marketing_pages_search_explore_provider_enabled\n        ? [new ExploreProvider(this.queryBuilder)]\n        : []\n\n      const providers: Provider[] = [\n        new LanguagesProvider(this.queryBuilder),\n        new ReposFilterProvider(this.queryBuilder, this),\n        new ReposSearchProvider(this.queryBuilder, this),\n        new OwnersProvider(this.queryBuilder, this),\n        new FixedValuesProvider(this.queryBuilder),\n        new TeamsProvider(this.queryBuilder, this),\n        new ProjectsProvider(this.queryBuilder, this),\n        new InputProvider(this.queryBuilder, this),\n      ]\n\n      if (isLoggedIn()) {\n        providers.push(...loggedInProviders)\n      } else {\n        providers.push(...loggedOutProviders)\n      }\n\n      this.queryBuilder.initialize(this.parser, providers)\n      // Sync the initial state with querybuilder\n      this.query = this.getAttribute('data-initial-value') || ''\n    })()\n\n    this.queryBuilder.parentElement?.addEventListener('submit', (event: Event) => {\n      this.search(this.queryBuilder.query)\n      this.retract()\n      this.queryBuilder.inputSubmit()\n      event.preventDefault()\n    })\n\n    this.queryBuilder.addEventListener('blackbird-monolith.manageCustomScopes', e => {\n      if (this.#customScopeManagerInitialized) {\n        this.#openManageCustomScopesDialog(e)\n      }\n    })\n\n    this.queryBuilder.addEventListener('query-builder:navigate', e => {\n      // If the navigation is a hash navigation, emit the scrollLineIntoView event\n      const href = (e as CustomEvent).detail?.url\n      if (href) {\n        const url = new URL(href, window.location.origin)\n        if (url.origin === window.location.origin && url.pathname === window.location.pathname) {\n          const anchInfo = parseFileAnchor(url.hash)\n          if (anchInfo.blobRange?.start?.line) {\n            window.dispatchEvent(\n              new CustomEvent('react_blob_view_scroll_line_into_view', {\n                detail: {line: anchInfo.blobRange.start.line},\n              }),\n            )\n          }\n        }\n      }\n      this.retract()\n    })\n\n    this.queryBuilder.addEventListener('blackbird-monolith.search', e => {\n      this.search((e as CustomEvent).detail?.query ?? '')\n    })\n\n    this.queryBuilder.addEventListener('search-copilot-chat', e => {\n      window.dispatchEvent(\n        new SearchCopilotEvent((e as CustomEvent).detail?.content, (e as CustomEvent).detail?.repoNwo),\n      )\n      this.retract()\n    })\n\n    this.queryBuilder.addEventListener('convert-to-query-syntax', async e => {\n      sendEvent('copilot_natural_language_github_search')\n\n      this.search((e as CustomEvent).detail.content)\n      this.retract()\n    })\n\n    // add current page to recently visited list for jump-to\n    logPageView(window.location.pathname)\n  }\n\n  syncRichButtonText() {\n    if (!this.#globalNavAlwaysHidden) {\n      return\n    }\n\n    if (this.query === '') {\n      const placeholder = this.inputButton.getAttribute('placeholder')\n      if (placeholder) {\n        this.inputButtonText.textContent = this.inputButton.getAttribute('placeholder')\n      } else {\n        this.inputButtonText.innerHTML = this.placeholderText\n      }\n      this.inputButton.classList.add('placeholder')\n    } else {\n      // TODO: get styled content from query builder\n      const flat = this.parser.flatten(this.parser.parse(this.query, undefined))\n\n      const segments = []\n      for (const el of flat) {\n        const span = document.createElement('span')\n        span.textContent = el.value\n        if (el.style === TextElementStyle.FilterValue) {\n          span.classList.add('input-parsed-symbol')\n        } else if (el.style === TextElementStyle.Constant) {\n          span.classList.add('pl-c1')\n        } else if (el.style === TextElementStyle.Entity) {\n          span.classList.add('pl-en')\n        }\n\n        segments.push(span)\n      }\n\n      this.inputButtonText.replaceChildren(...segments)\n    }\n  }\n\n  setButtonText(newText: string) {\n    // Only overwrite the button text if we're on a page with a wide search bar.\n    if (!this.#globalNavAlwaysHidden || newText.trim() === '') {\n      const placeholder = this.inputButton.getAttribute('placeholder')\n      if (placeholder) {\n        this.inputButtonText.textContent = this.inputButton.getAttribute('placeholder')\n      } else if (this.inputButtonText.innerHTML.trim() !== this.placeholderText) {\n        this.inputButtonText.innerHTML = this.placeholderText\n      }\n      this.inputButton.classList.add('placeholder')\n    } else {\n      this.inputButtonText.textContent = newText\n      this.inputButton.classList.remove('placeholder')\n    }\n  }\n\n  async moveCaretToEndOfInput() {\n    await window.customElements.whenDefined('query-builder')\n    this.queryBuilder.moveCaretToEndOfInput()\n  }\n\n  disconnectedCallback() {\n    this.#eventAbortController?.abort()\n  }\n\n  // todo: remove?\n  getSuggestionInputState(): SuggestionInputState {\n    let customScopes: CustomScope[] = []\n    if (this.ast) {\n      customScopes = this.#findCustomScopesNeededForSearch(this.ast)\n    }\n    return {\n      query: this.query.replaceAll(nonBreakingSpace, ' '),\n      ast: this.ast,\n      selectedNode: this.#caretSelectedNode,\n      mode: this.#caretPositionKind,\n      customScopes,\n      type: this.ast ? this.chooseSearchType(this.ast) : ('' as Parsing.SearchType),\n    }\n  }\n\n  setGlobalNavVisibility(visible: boolean) {\n    const globalNav = document.querySelector('#global-nav') as HTMLElement\n    const mediaQuery = window.matchMedia('(min-width: 768px)')\n    if (globalNav && mediaQuery.matches) {\n      globalNav.hidden = !visible\n    }\n  }\n\n  setGlobalBarAlwaysExpanded(alwaysExpanded: boolean) {\n    if (!this.headerRedesignEnabled) return\n\n    const globalBar = document.querySelector('.js-global-bar') as HTMLElement\n    if (globalBar) {\n      if (alwaysExpanded) {\n        globalBar.classList.add('always-expanded')\n      } else {\n        globalBar.classList.remove('always-expanded')\n      }\n    }\n  }\n\n  setGlobalBarModalOpen(modalOpen: boolean) {\n    if (!this.headerRedesignEnabled) return\n\n    const globalBar = document.querySelector('.js-global-bar') as HTMLElement\n    if (globalBar) {\n      if (modalOpen) {\n        globalBar.classList.add('search-expanded')\n      } else {\n        globalBar.classList.remove('search-expanded')\n      }\n    }\n  }\n\n  // NOTE: when the search input container is clicked directly, we should expand\n  // the search input. But pretty much everything inside it will bubble up click\n  // events here, so we should ignore clicks on any INNER element that bubbles\n  // up to the container.\n  searchInputContainerClicked(event: MouseEvent) {\n    if ((event.target as HTMLDivElement).classList.contains('search-input-container')) {\n      this.expand(this.isRetainScrollPosition())\n    }\n    sendEvent('blackbird.click', {target: 'SEARCH_BOX'})\n  }\n\n  async updateQueryBuilderVisibility() {\n    await window.customElements.whenDefined('query-builder')\n    this.queryBuilderContainer.hidden = !this.classList.contains('expanded')\n    this.darkBackdrop.hidden = this.queryBuilderContainer.hidden\n  }\n\n  expandAndRetainScrollPosition(trigger: HTMLElement | null) {\n    if (this.isRetainScrollPosition()) return this.expand(true)\n    if (window.scrollY > 200) {\n      this.classList.add('search-input-absolute')\n      this.style.top = `${window.scrollY + 25}px`\n      this.expand(true)\n      this.#returnFocusElement = trigger\n    } else {\n      this.expand()\n    }\n  }\n\n  handleExpand() {\n    this.expand(this.isRetainScrollPosition())\n  }\n\n  async expand(retainScrollPosition?: boolean) {\n    if (this.classList.contains('expanded')) return\n\n    if (!retainScrollPosition) {\n      window.scrollTo(0, 0)\n    }\n\n    this.blackbirdCaches.setupWarmCachesLoop()\n\n    this.#returnFocusElement = this.inputButton\n    if (this.searchSuggestionsDialog instanceof HTMLDialogElement) {\n      this.searchSuggestionsDialog.showModal()\n    } else {\n      this.searchSuggestionsDialog.show()\n    }\n\n    this.classList.add('expanded')\n    this.setGlobalNavVisibility(false)\n    this.setGlobalBarModalOpen(true)\n    this.updateQueryBuilderVisibility()\n\n    // Ensure that querybuilder is connected\n    await window.customElements.whenDefined('query-builder')\n\n    if (this.query === '' && this.getAttribute('data-scope')) {\n      this.query = `${this.getAttribute('data-scope')} `\n    }\n\n    this.queryBuilder.inputFocus()\n    this.moveCaretToEndOfInput()\n    this.queryBuilder.inputChange()\n\n    this.parseSearchInputRaw()\n\n    document.dispatchEvent(new CustomEvent('qbsearch-input:expand', {detail: {element: this}}))\n  }\n\n  handleClose = (e: Event) => {\n    this.syncRichButtonText()\n    this.classList.remove('expanded')\n    if (!this.#globalNavAlwaysHidden) {\n      this.setGlobalNavVisibility(true)\n    }\n    this.setGlobalBarModalOpen(false)\n    this.updateQueryBuilderVisibility()\n\n    e.preventDefault()\n\n    if (this.classList.contains('search-input-absolute')) {\n      this.classList.remove('search-input-absolute')\n    }\n\n    // When the dialog is closed, the focus gets moved to the search element by default\n    // We need to guarantee that this is called after that happens, so set a timeout for 0ms\n    // which will cause this to run on the next cycle.\n    setTimeout(() => {\n      this.#returnFocusElement?.focus()\n\n      document.dispatchEvent(new CustomEvent('qbsearch-input:close', {detail: {element: this}}))\n    }, 0)\n  }\n\n  retract = () => {\n    this.searchSuggestionsDialog.close()\n    this.#returnFocusElement?.focus()\n  }\n\n  chooseSearchType(ast: BaseNode): Parsing.SearchType {\n    const type = new URLSearchParams(window.location.search).get('type') as Parsing.SearchTypeURLParameter\n    if (type) return this.parsing!.mapURLParamToSearchType(type)\n    return this.parsing!.chooseSearchType(ast, isLoggedIn())\n  }\n\n  async search(query: string, openInNewWindow = false) {\n    const parser = await this.loadParser()\n    const ast = parser.parseString(query)\n    const customScopes = this.#findCustomScopesNeededForSearch(ast)\n    const searchType = parser.mapSearchTypeToURLParam(this.chooseSearchType(ast))\n\n    const redirectURL = shouldRedirectInsteadOfSearch(ast, window.location.pathname)\n    if (redirectURL) {\n      softNavigate(redirectURL)\n      return\n    }\n\n    if (this.#isReactContext && !openInNewWindow) {\n      const searchParams: {\n        type: Parsing.SearchTypeURLParameter\n        saved_searches?: string\n        p: null\n        l: null\n        expanded_query?: string\n      } = {\n        type: searchType,\n        // Set page to null so that the search jumps us back to page zero\n        p: null,\n        l: null,\n      }\n\n      if (customScopes.length > 0) {\n        searchParams['saved_searches'] = JSON.stringify(customScopes)\n        searchParams['expanded_query'] = parser.getExpandedQuery(query, customScopes, ast)\n      } else {\n        // Set to undefined to clear them from the URL when there are no saved searches in query\n        searchParams['saved_searches'] = undefined\n        searchParams['expanded_query'] = undefined\n      }\n\n      // If we're in a react context, then allow react to do the searching for us\n      window.dispatchEvent(\n        new CustomEvent('blackbird_monolith_search', {\n          detail: {\n            search: query,\n            searchParams,\n          },\n        }),\n      )\n    } else {\n      // If we're not in a react context, then we need to do the search ourselves\n      let typeParam = ''\n      if (searchType !== '') {\n        typeParam = `&type=${encodeURIComponent(searchType)}`\n      }\n\n      let href = `/search?q=${encodeURIComponent(query)}${typeParam}`\n\n      // Only add the saved_searches param if it's not empty\n      if (customScopes.length > 0) {\n        href += `&saved_searches=${encodeURIComponent(JSON.stringify(customScopes))}`\n        const expandedQuery = encodeURIComponent(parser.getExpandedQuery(query, customScopes, ast))\n        href += `&expanded_query=${expandedQuery}`\n      }\n\n      const experimentsParam = getBlackbirdExperiments().join(',')\n      if (experimentsParam !== '') {\n        href += `&experiments=${experimentsParam}`\n      }\n\n      if (openInNewWindow) {\n        // this actually usually goes to a new tab, except in Chrome and Safari where if you use shift+enter, it opens in a new window for magical reasons\n        window.open(href, '_blank')\n      } else {\n        softNavigate(href)\n      }\n    }\n  }\n\n  #findCustomScopesNeededForSearch(ast: BaseNode): CustomScope[] {\n    // It shouldn't be possible for parsing not to be loaded here, since we are\n    // being passed a parsed AST.\n    if (!this.parsing) {\n      return []\n    }\n\n    const customScopeNames = this.parsing.getCustomScopeNames(ast)\n\n    let customScopesFromUrl: CustomScope[]\n    try {\n      customScopesFromUrl = JSON.parse(new URLSearchParams(window.location.search).get('saved_searches') || '[]')\n      if (!Array.isArray(customScopesFromUrl)) {\n        customScopesFromUrl = []\n      }\n    } catch {\n      customScopesFromUrl = []\n    }\n\n    const customScopesNeededForSearch: CustomScope[] = []\n    for (const customScopeName of customScopeNames) {\n      const customScope =\n        customScopesFromUrl.find(scope => scope.name === customScopeName) ||\n        this.#customScopesSuggestionProvider.customScopesCache.get()?.find(scope => scope.name === customScopeName)\n      if (customScope) {\n        customScopesNeededForSearch.push({name: customScope.name, query: customScope.query} as CustomScope)\n      }\n    }\n    return customScopesNeededForSearch\n  }\n\n  setLocalHistory(query: string) {\n    // Don't save empty queries\n    if (query.trim() === '') return\n\n    let localStorage: string[] = JSON.parse(window.localStorage.getItem('github-search-history') ?? '[]')\n    if (localStorage.length >= MAX_LOCAL_HISTORY) {\n      // keep the last 50 items\n      localStorage = localStorage.slice(0, MAX_LOCAL_HISTORY - 1)\n    }\n\n    if (!localStorage.find(item => item.toLowerCase() === query.toLowerCase())) {\n      localStorage.unshift(query)\n    }\n\n    window.localStorage.setItem('github-search-history', JSON.stringify(localStorage))\n  }\n\n  handleChange() {\n    this.parseSearchInput()\n  }\n\n  async loadParser() {\n    if (!this.parsingPromise) {\n      this.parsingPromise = import('./parsing/parsing')\n      this.parsing = await this.parsingPromise\n    }\n    return this.parsingPromise\n  }\n\n  #waitingToParse = false\n  #lastParseTime = 0\n  parseSearchInput() {\n    // the throttle() function in @github/mini-throttle is broken (although debounce() works), so\n    // implement our own throttling here until that gets fixed\n    const now = Date.now()\n    if (now - this.#lastParseTime > parseDelay && !this.#waitingToParse) {\n      this.parseSearchInputRaw()\n    } else if (!this.#waitingToParse) {\n      this.#waitingToParse = true\n      setTimeout(\n        () => {\n          this.#waitingToParse = false\n          this.parseSearchInputRaw()\n        },\n        parseDelay - (now - this.#lastParseTime),\n      )\n    }\n  }\n\n  // NOTE: this is the non-debounced version of parseSearchInput\n  async parseSearchInputRaw() {\n    if (!this.query) {\n      // if the query is blank we don't need to parse or load the parser\n      this.lastParsedQuery = this.query\n      this.ast = {kind: 'Nothing'} as NothingNode\n      this.#caretPositionKind = CaretPositionKind.Text\n      this.#caretSelectedNode = undefined\n      return\n    }\n\n    if (!this.parsing) {\n      await this.loadParser()\n    }\n\n    this.#lastParseTime = Date.now()\n    if (!this.ast || this.query !== this.lastParsedQuery) {\n      this.lastParsedQuery = this.query\n      const [ast /*, nodes */] = this.parsing!.parseSearchInput(this.lastParsedQuery)\n      this.ast = ast\n    }\n\n    // TODO: get caret position properly\n    const caretData = this.parsing!.getCaretPositionKindFromIndex(this.ast, 0)\n    this.#caretPositionKind = caretData.kind\n    this.#caretSelectedNode = caretData.node\n  }\n\n  handleSubmit(openInNewWindow = false) {\n    // If the query is totally empty, just do nothing and ignore it\n    if (this.query.trim().length === 0) {\n      return\n    }\n\n    this.setLocalHistory(this.query)\n    this.search(this.query, openInNewWindow)\n    this.retract()\n  }\n\n  editCustomScope(event: Event) {\n    this.customScopesManager.editCustomScope(event)\n  }\n\n  async #openManageCustomScopesDialog(event: Event) {\n    this.retract()\n    this.customScopesManager.show()\n\n    // Stop propagation so that the scope isn't also selected\n    event.stopPropagation()\n  }\n\n  newCustomScope(event: Event) {\n    this.customScopesManager.create('')\n    event.stopPropagation()\n  }\n\n  saveQueryAsCustomScope(event: CustomEvent<HTMLElement>) {\n    this.customScopesManager.create(this.query)\n    this.#dialogFocusReturn = event.detail\n  }\n\n  handleDialogClose() {\n    // after the dialog closes, attempt to return the focus to the element that opened it\n    setTimeout(() => {\n      if (this.#dialogFocusReturn) {\n        this.#dialogFocusReturn?.focus()\n        this.#dialogFocusReturn = undefined\n      } else {\n        this.inputButton.focus()\n      }\n    })\n  }\n\n  showFeedbackDialog(event: Event) {\n    this.feedbackDialog.show()\n    this.retract()\n    // Stop propagation so that the modal will stay open\n    event.stopPropagation()\n    event.preventDefault()\n  }\n\n  async submitFeedback(event: Event) {\n    event.preventDefault()\n\n    const form = (event.target as HTMLButtonElement).form!\n    await fetch(form.action, {\n      method: 'POST',\n      body: new FormData(form),\n    })\n    this.feedbackDialog.close()\n  }\n}\n\nclass SearchCopilotEvent extends Event {\n  declare content: string\n  declare repoNwo: string\n  constructor(content: string, repoNwo: string) {\n    super('search-copilot-chat', {\n      bubbles: false,\n      cancelable: true,\n    })\n\n    this.content = content\n    this.repoNwo = repoNwo\n  }\n}\n","import {isLoggedIn} from '@github-ui/client-env'\nimport {verifiedFetchJSON} from '@github-ui/verified-fetch'\n\nexport type WarmCachesResponse = {\n  userCacheExpiresAt: string\n}\n\nexport class BlackbirdPermissionCaches {\n  protected static warmCachesLoopSetup = false\n  protected static warmResolve: (value: void) => void\n  protected static warm = new Promise<void>(resolve => {\n    BlackbirdPermissionCaches.warmResolve = resolve\n  })\n\n  async setupWarmCachesLoop() {\n    if (!isLoggedIn()) {\n      return\n    }\n    if (!BlackbirdPermissionCaches.warmCachesLoopSetup) {\n      BlackbirdPermissionCaches.warmCachesLoopSetup = true\n      await this.warmCaches()\n    } else {\n      await BlackbirdPermissionCaches.warm\n    }\n  }\n\n  async warmCaches() {\n    let ttl = 9 * 60 * 1000 // 9 minutes\n    try {\n      // Warm blackbird's user ACL cache, making searches faster. It's OK to call repeatedly since it's a noop if the\n      // caches are already warm.\n      const resp = await verifiedFetchJSON('/search/warm_blackbird_caches', {\n        headers: {Accept: 'application/json', 'X-Requested-With': 'XMLHttpRequest'},\n      })\n      const data = (await resp.json()) as WarmCachesResponse\n      ttl = new Date(data.userCacheExpiresAt).getTime() - Date.now()\n      ttl = ttl - 30 * 1000 // less 30 seconds so that we warm before it expires.\n      if (isNaN(ttl) || ttl <= 5) {\n        ttl = 30 * 1000\n      }\n    } catch {\n      // no-op\n    }\n    BlackbirdPermissionCaches.warmResolve()\n    setTimeout(() => {\n      void this.warmCaches()\n    }, ttl)\n  }\n}\n","export type AuthTokenResult = {\n  token: string\n  expiration: string\n}\n\nexport type SerializedAuthToken = {\n  value: string\n  expiration: string\n  ssoOrgIDs: string[]\n}\n\n/**\n * AuthToken represents an authentication token that is passed to CAPI, which is used to pull resources\n * from the monolith.\n *\n * It is capable of determining which authorization scheme to use (Bearer for SSATs or our own\n * GitHub-Bearer for user tokens).\n *\n * It also can tell if it needs refreshing, i.e. if it is expired or if the SSO orgs have changed since\n * it was minted.\n *\n * AuthToken doesn't care where the list of SSO orgs comes from.  Typically they are hydrated into a React\n * partial/component via props sent from the server, which would require a page refresh to receive the\n * current list, but they could theoretically come from other places too, like API calls...\n *\n * Finally, it can convert itself to/from ordinary JS objects that can be stored/retrieved from\n * local storage.\n */\nexport class AuthToken {\n  value: string\n  expiration: string\n  ssoOrgIDs: string[]\n\n  constructor(value: string, expiration: string, ssoOrgIDs: string[]) {\n    this.value = value\n    this.expiration = expiration\n    this.ssoOrgIDs = ssoOrgIDs\n  }\n\n  /**\n   * Returns a formatted string to be used as the value of an `Authorization` header\n   * to be \"GitHub-Bearer <encrypted token>\"\n   */\n  get authorizationHeaderValue() {\n    return `GitHub-Bearer ${this.value}`\n  }\n\n  /**\n   * Returns true if this auth token needs to be refreshed.\n   */\n  needsRefreshing(ssoOrgIds: string[]) {\n    return this.isExpired || this.ssoChanged(ssoOrgIds)\n  }\n\n  /**\n   * Returns true if this auth token is expired.\n   */\n  get isExpired() {\n    const expirationDateString = new Date(this.expiration)\n\n    const expirationDate = new Date(\n      Date.UTC(\n        expirationDateString.getUTCFullYear(),\n        expirationDateString.getUTCMonth(),\n        expirationDateString.getUTCDate(),\n        expirationDateString.getUTCHours(),\n        expirationDateString.getUTCMinutes(),\n        expirationDateString.getUTCSeconds(),\n        expirationDateString.getUTCMilliseconds(),\n      ),\n    )\n\n    const padding = 15 * 1000 // seconds\n\n    return expirationDate < new Date(Date.now() + padding)\n  }\n\n  /**\n   * Returns true if the session's SSO'd organizations have changed since the token was originally issued.\n   *\n   * Technically the set of orgs is inverted, representing the orgs that are *not* SSO'd, but functionally\n   * it will operate the same.\n   */\n  ssoChanged(ssoOrgIDs: string[]) {\n    return !(\n      this.ssoOrgIDs.every(org => ssoOrgIDs.includes(org)) && ssoOrgIDs.every(org => this.ssoOrgIDs.includes(org))\n    )\n  }\n\n  /**\n   * Build a new AuthToken from the results of a call to the token API endpoint.\n   */\n  static fromResult(result: AuthTokenResult, orgIds: string[]) {\n    return new AuthToken(result.token, result.expiration, orgIds)\n  }\n\n  /**\n   * Convert this token into a plain JS object, which can be stringified and put into localStorage.\n   */\n  serialize(): SerializedAuthToken {\n    return {\n      value: this.value,\n      expiration: this.expiration,\n      ssoOrgIDs: this.ssoOrgIDs,\n    }\n  }\n\n  /**\n   * Build a new auth token from a plain JS object, i.e. one parsed from localStorage.\n   */\n  static deserialize(serialized: SerializedAuthToken): AuthToken {\n    return new AuthToken(serialized.value, serialized.expiration, serialized.ssoOrgIDs)\n  }\n}\n","import {AuthToken, type AuthTokenResult, type SerializedAuthToken} from './auth-token'\nimport safeStorage from '@github-ui/safe-storage'\nimport {verifiedFetchJSON} from '@github-ui/verified-fetch'\n\nconst COPILOT_AUTH_TOKEN_KEY = 'COPILOT_AUTH_TOKEN'\nexport class CopilotAuthTokenProvider {\n  ssoOrgIDs: string[]\n  currentAuthTokenRequest: Promise<AuthToken> | null\n  copilotLocalStorage: {\n    getItem: (key: string, now?: number) => string | null\n    setItem: (key: string, value: string, now?: number) => void\n  }\n\n  constructor(ssoOrgIDs: string[]) {\n    this.ssoOrgIDs = ssoOrgIDs\n    this.currentAuthTokenRequest = null\n    this.copilotLocalStorage = safeStorage('localStorage', {\n      throwQuotaErrorsOnSet: false,\n      ttl: 1000 * 60 * 60 * 24,\n    })\n  }\n\n  /**\n   * Get the current auth token, either from local storage or by minting a new one from dotcom.\n   */\n  async getAuthToken(): Promise<AuthToken> {\n    const token = this.getLocalStorageAuthToken()\n\n    return token ? this.validateAuthToken(token) : this.fetchAuthToken()\n  }\n\n  setLocalStorageAuthToken(token: AuthToken) {\n    this.copilotLocalStorage.setItem(COPILOT_AUTH_TOKEN_KEY, JSON.stringify(token.serialize()))\n  }\n\n  getLocalStorageAuthToken(): AuthToken | null {\n    const value = this.copilotLocalStorage.getItem(COPILOT_AUTH_TOKEN_KEY)\n\n    return value ? AuthToken.deserialize(JSON.parse(value) as SerializedAuthToken) : null\n  }\n\n  /**\n   * Validate the given auth token.  If it's all good, return it, otherwise, go mint a new one from\n   * dotcom and return it instead.\n   */\n  private async validateAuthToken(token: AuthToken): Promise<AuthToken> {\n    return token.needsRefreshing(this.ssoOrgIDs) ? this.fetchAuthToken() : token\n  }\n\n  /**\n   * Return the current auth token request, or start a new one.\n   *\n   * The inner workings of the chat app can cause multiple requests to CAPI in quick succession.  If we\n   * do not have an auth token available in local storage, each of those requests will trigger their own\n   * token fetch, hence the storing of the current request on `this`.\n   */\n  private fetchAuthToken(): Promise<AuthToken> {\n    if (!this.currentAuthTokenRequest) {\n      this.currentAuthTokenRequest = this._fetchAuthToken()\n    }\n\n    return this.currentAuthTokenRequest\n  }\n\n  /**\n   * Start a new auth token request, parsing the result, persisting it in local storage,\n   * and clearing the current request once finished.\n   */\n  private async _fetchAuthToken(): Promise<AuthToken> {\n    const response = await verifiedFetchJSON('/github-copilot/chat/token', {method: 'POST'})\n\n    if (response.ok) {\n      const result = (await response.json()) as AuthTokenResult\n      this.currentAuthTokenRequest = null\n\n      const token = AuthToken.fromResult(result, this.ssoOrgIDs)\n\n      this.setLocalStorageAuthToken(token)\n\n      return token\n    } else {\n      this.currentAuthTokenRequest = null\n\n      throw new Error('Failed to mint new auth token')\n    }\n  }\n}\n","import safeStorage from './safe-storage'\n\nexport const {getItem, setItem, removeItem} = safeStorage('sessionStorage')\n","import {SOFT_NAV_STATE} from './states'\n\nexport type SoftNavMechanism = 'turbo' | 'react' | 'turbo.frame'\n\nclass SoftNavEvent extends Event {\n  mechanism: SoftNavMechanism\n\n  constructor(mechanism: SoftNavMechanism, type: string) {\n    super(type)\n    this.mechanism = mechanism\n  }\n}\n\nexport class SoftNavStartEvent extends SoftNavEvent {\n  constructor(mechanism: SoftNavMechanism) {\n    super(mechanism, SOFT_NAV_STATE.START)\n  }\n}\n\nexport class SoftNavReplaceMechanismEvent extends SoftNavEvent {\n  constructor(mechanism: SoftNavMechanism) {\n    super(mechanism, SOFT_NAV_STATE.REPLACE_MECHANISM)\n  }\n}\n\nexport class SoftNavSuccessEvent extends SoftNavEvent {\n  visitCount: number\n\n  constructor(mechanism: SoftNavMechanism, visitCount: number) {\n    super(mechanism, SOFT_NAV_STATE.SUCCESS)\n    this.visitCount = visitCount\n  }\n}\n\nexport class SoftNavErrorEvent extends SoftNavEvent {\n  error: string\n\n  constructor(mechanism: SoftNavMechanism, error: string) {\n    super(mechanism, SOFT_NAV_STATE.ERROR)\n    this.error = error\n  }\n}\n\nexport class SoftNavEndEvent extends SoftNavEvent {\n  constructor(mechanism: SoftNavMechanism) {\n    super(mechanism, SOFT_NAV_STATE.END)\n  }\n}\n","import {SOFT_NAV_STATE} from './states'\nimport {\n  SoftNavEndEvent,\n  SoftNavErrorEvent,\n  type SoftNavMechanism,\n  SoftNavReplaceMechanismEvent,\n  SoftNavStartEvent,\n  SoftNavSuccessEvent,\n} from './events'\nimport {markStart, sendFailureStats, sendRenderStats} from './stats'\nimport {\n  clearSoftNav,\n  getSoftNavFailReason,\n  getSoftNavMechanism,\n  setSoftNavMechanism,\n  unsetSoftNav,\n  setSoftNavReferrer,\n  setSoftNavReactAppName,\n  inSoftNav,\n  reactAppPresent,\n  DEFAULT_SOFT_NAV_ERROR_REASON,\n  setLatestMechanism,\n} from './utils'\n\ninterface SoftNavOptions {\n  skipIfGoingToReactApp?: boolean\n  allowedMechanisms?: SoftNavMechanism[]\n}\n\nlet visitCount = 0\n\nexport function initSoftNav() {\n  visitCount = 0\n  document.dispatchEvent(new Event(SOFT_NAV_STATE.INITIAL))\n\n  clearSoftNav()\n}\n\nexport function startSoftNav(mechanism: SoftNavMechanism) {\n  if (inSoftNav()) return\n\n  startProgressBar()\n  document.dispatchEvent(new SoftNavStartEvent(mechanism))\n\n  setSoftNavMechanism(mechanism)\n  setSoftNavReactAppName()\n  setSoftNavReferrer()\n  markStart()\n}\n\nexport function replaceSoftNavMechanism(mechanism: SoftNavMechanism) {\n  if (!inSoftNav()) return\n\n  setSoftNavMechanism(mechanism)\n  document.dispatchEvent(new SoftNavReplaceMechanismEvent(mechanism))\n}\n\nexport function succeedSoftNav(options: SoftNavOptions = {}) {\n  if (!canTriggerEvent(options)) return\n\n  visitCount += 1\n\n  document.dispatchEvent(new SoftNavSuccessEvent(getSoftNavMechanism(), visitCount))\n  endSoftNav(options)\n}\n\nexport function failSoftNav(options: SoftNavOptions = {}) {\n  if (!canTriggerEvent(options)) return\n\n  visitCount = 0\n  const reason = getSoftNavFailReason() || DEFAULT_SOFT_NAV_ERROR_REASON\n  document.dispatchEvent(new SoftNavErrorEvent(getSoftNavMechanism(), reason))\n\n  endProgressBar()\n  sendFailureStats(reason)\n  clearSoftNav()\n}\n\nexport function endSoftNav(options: SoftNavOptions = {}) {\n  if (!canTriggerEvent(options)) return\n\n  const mechanism = getSoftNavMechanism()\n  endProgressBar()\n  document.dispatchEvent(new SoftNavEndEvent(mechanism))\n\n  unsetSoftNav()\n  setLatestMechanism(mechanism)\n}\n\nexport function renderedSoftNav(options: SoftNavOptions = {}) {\n  if (!canTriggerEvent(options)) return\n\n  sendRenderStats()\n  document.dispatchEvent(new Event(SOFT_NAV_STATE.RENDER))\n}\n\nexport function updateFrame() {\n  document.dispatchEvent(new Event(SOFT_NAV_STATE.FRAME_UPDATE))\n}\n\nfunction startProgressBar() {\n  document.dispatchEvent(new Event(SOFT_NAV_STATE.PROGRESS_BAR.START))\n}\n\nfunction endProgressBar() {\n  document.dispatchEvent(new Event(SOFT_NAV_STATE.PROGRESS_BAR.END))\n}\n\nfunction canTriggerEvent({skipIfGoingToReactApp, allowedMechanisms = []}: SoftNavOptions = {}) {\n  return (\n    inSoftNav() &&\n    (allowedMechanisms.length === 0 || allowedMechanisms.includes(getSoftNavMechanism())) &&\n    (!skipIfGoingToReactApp || !reactAppPresent()) // react apps will end the soft nav in useNavigator\n  )\n}\n","export const SOFT_NAV_STATE = Object.freeze({\n  INITIAL: 'soft-nav:initial',\n  START: 'soft-nav:start',\n  REPLACE_MECHANISM: 'soft-nav:replace-mechanism',\n  SUCCESS: 'soft-nav:success',\n  ERROR: 'soft-nav:error',\n  FRAME_UPDATE: 'soft-nav:frame-update',\n  END: 'soft-nav:end',\n  RENDER: 'soft-nav:render',\n  PROGRESS_BAR: {\n    START: 'soft-nav:progress-bar:start',\n    END: 'soft-nav:progress-bar:end',\n  },\n})\n","import {sendStats} from '@github-ui/stats'\nimport {getCurrentReactAppName, getSoftNavMechanism, getSoftNavReactAppName, getSoftNavReferrer} from './utils'\nimport type {SoftNavMechanism} from './events'\n\nexport const SOFT_NAV_DURATION_MARK = 'stats:soft-nav-duration'\nexport const MECHANISM_MAPPING: Record<SoftNavMechanism | 'ui' | 'hard', PlatformBrowserSoftNavigationMechanism> = {\n  turbo: 'TURBO',\n  react: 'REACT',\n  'turbo.frame': 'FRAME',\n  ui: 'UI',\n  hard: 'HARD',\n}\nexport function markStart() {\n  // browswers only record the first ~150 resources\n  // clearing it here provides room to track additional resources loaded during the soft-nav\n  window.performance.clearResourceTimings()\n  window.performance.mark(SOFT_NAV_DURATION_MARK)\n}\n\nfunction getDurationSinceLastSoftNav() {\n  if (performance.getEntriesByName(SOFT_NAV_DURATION_MARK).length === 0) {\n    return null\n  }\n\n  performance.measure(SOFT_NAV_DURATION_MARK, SOFT_NAV_DURATION_MARK)\n  const measures = performance.getEntriesByName(SOFT_NAV_DURATION_MARK)\n  const measure = measures.pop()\n  return measure ? measure.duration : null\n}\n\nexport function sendFailureStats(turboFailureReason: string) {\n  sendStats({\n    turboFailureReason,\n    turboStartUrl: getSoftNavReferrer(),\n    turboEndUrl: window.location.href,\n  })\n}\n\nexport function sendRenderStats() {\n  const duration = getDurationSinceLastSoftNav()\n\n  if (!duration) return\n\n  const mechanism = MECHANISM_MAPPING[getSoftNavMechanism()]\n  const roundedDuration = Math.round(duration)\n\n  if (mechanism === MECHANISM_MAPPING.react)\n    document.dispatchEvent(new CustomEvent('staffbar-update', {detail: {duration: roundedDuration}}))\n\n  sendStats({\n    requestUrl: window.location.href,\n    softNavigationTiming: {\n      mechanism,\n      destination: getCurrentReactAppName() || 'rails',\n      duration: roundedDuration,\n      initiator: getSoftNavReactAppName() || 'rails',\n    },\n  })\n}\n","import {getItem, removeItem, setItem} from '@github-ui/safe-storage/session-storage'\nimport type {SoftNavMechanism} from './events'\n\nexport const DEFAULT_SOFT_NAV_ERROR_REASON = 'reload'\n\nexport const SOFT_NAV_FAIL = 'soft-nav:fail'\nexport const SOFT_NAV_FAIL_REFERRER = 'soft-nav:fail-referrer'\nexport const SOFT_NAV_REFERRER = 'soft-nav:referrer'\nexport const SOFT_NAV_MARK = 'soft-nav:marker'\nexport const SOFT_NAV_REACT_APP_NAME = 'soft-nav:react-app-name'\nexport const SOFT_NAV_LATEST_MECHANISM = 'soft-nav:latest-mechanism'\n\nexport function clearSoftNav() {\n  setItem(SOFT_NAV_MARK, '0')\n  removeItem(SOFT_NAV_REFERRER)\n  removeItem(SOFT_NAV_FAIL)\n  removeItem(SOFT_NAV_FAIL_REFERRER)\n  removeItem(SOFT_NAV_REACT_APP_NAME)\n  removeItem(SOFT_NAV_LATEST_MECHANISM)\n}\n\nexport function setSoftNavMechanism(mechanism: SoftNavMechanism) {\n  setItem(SOFT_NAV_MARK, mechanism)\n}\n\nexport function unsetSoftNav() {\n  setItem(SOFT_NAV_MARK, '0')\n}\n\nexport function inSoftNav() {\n  const softNav = getItem(SOFT_NAV_MARK)\n  return softNav && softNav !== '0'\n}\n\nexport function getSoftNavMechanism(): SoftNavMechanism {\n  return getItem(SOFT_NAV_MARK) as SoftNavMechanism\n}\n\nexport function hasSoftNavFailure() {\n  return Boolean(getSoftNavFailReason())\n}\n\nexport function getSoftNavFailReason() {\n  return getItem(SOFT_NAV_FAIL)\n}\n\nexport function setSoftNavFailReason(reason: string) {\n  setItem(SOFT_NAV_FAIL, reason || DEFAULT_SOFT_NAV_ERROR_REASON)\n  setItem(SOFT_NAV_FAIL_REFERRER, window.location.href)\n}\n\nexport function setSoftNavReferrer() {\n  setItem(SOFT_NAV_REFERRER, window.location.href)\n}\n\nexport function getSoftNavReferrer() {\n  return getItem(SOFT_NAV_REFERRER) || document.referrer\n}\n\nexport function setSoftNavReactAppName() {\n  const appName = getCurrentReactAppName()\n\n  if (appName) {\n    setItem(SOFT_NAV_REACT_APP_NAME, appName)\n  } else {\n    removeItem(SOFT_NAV_REACT_APP_NAME)\n  }\n}\n\nexport function getSoftNavReactAppName() {\n  return getItem(SOFT_NAV_REACT_APP_NAME)\n}\n\nexport function getCurrentReactAppName() {\n  // special case for repos-overview that is a partial\n  if (document.querySelector('react-partial[partial-name=\"repos-overview\"]')) return 'repos-overview'\n\n  return document.querySelector('react-app')?.getAttribute('app-name')\n}\n\nexport function reactAppPresent() {\n  return !!document.querySelector('react-app')?.getAttribute('app-name')\n}\n\nexport function setLatestMechanism(mechanism: SoftNavMechanism) {\n  setItem(SOFT_NAV_LATEST_MECHANISM, mechanism)\n}\n\nexport function getLatestMechanism() {\n  return getItem(SOFT_NAV_LATEST_MECHANISM) as SoftNavMechanism\n}\n","import {startSoftNav} from '@github-ui/soft-nav/state'\nimport {visit} from '@github/turbo'\n\nexport const softNavigate: typeof visit = (url, turboOptions) => {\n  // visit won't fire a `turbo:click` event, so we need to manually start the soft navigation process.\n  startSoftNav('turbo')\n  visit(url, {...turboOptions})\n}\n","/**\n * A Fetch function which will automatically add the correct headers for\n * making requests to GitHub application servers as long as the associated controller methods allow it.\n * Track down the associated controller method and confirm the controller includes\n * ApplicationController::VerifiedFetchDependency as well as `allow_verified_fetch only:`\n * to the relevant controller methods.\n *\n * ## Example\n *\n *     const onClick = async () => {\n *       const resp = await verifiedFetch('/foo', {method: 'POST'})\n *       if (resp.ok) console.log('The response was', await resp.text())\ntest.\n *     }\n */\nexport function verifiedFetch(path: string, init: RequestInit = {}): Promise<Response> {\n  assertRelativePathOrSameOrigin(path)\n\n  const headers: HeadersInit = {\n    ...init.headers,\n    'GitHub-Verified-Fetch': 'true',\n    'X-Requested-With': 'XMLHttpRequest',\n  }\n\n  return fetch(path, {...init, headers})\n}\n\nexport interface JSONRequestInit extends Omit<RequestInit, 'body'> {\n  body?: unknown\n}\n\nfunction assertRelativePathOrSameOrigin(path: string) {\n  if (process.env.NODE_ENV === 'test' && !window.location.origin) return\n  const url = new URL(path, window.location.origin)\n  if (url.origin !== window.location.origin) {\n    throw new Error('Can not make cross-origin requests from verifiedFetch')\n  }\n}\n\n/**\n * A Fetch function which will automatically add the correct headers for\n * making JSON requests\n *\n * Will also `JSON.stringify` the request body if provided.\n\n * ## Example\n *\n *     const onClick = async () => {\n *       const resp = await verifiedFetchJSON('/foo', {body: {foo: 'bar'}, method: 'POST'})\n *       if (resp.ok) console.log('The response was', await resp.json())\n *     }\n */\nexport function verifiedFetchJSON(path: string, init?: JSONRequestInit): Promise<Response> {\n  const initHeaders: HeadersInit = init?.headers ?? {}\n\n  const headers: HeadersInit = {\n    ...initHeaders,\n    Accept: 'application/json',\n    'Content-Type': 'application/json',\n  }\n\n  const body = init?.body ? JSON.stringify(init.body) : undefined\n\n  return verifiedFetch(path, {...init, body, headers})\n}\n\n/**\n * A Fetch function which will automatically add the GitHub-Is-React header for\n * making JSON requests. It will in turn call verifiedFetchJSON.\n *\n * Using this in React components to fetch data enables us to track these\n * requests in Datadog in the request.dist.referrer metric.\n */\nexport function reactFetch(path: string, init: RequestInit = {}): Promise<Response> {\n  const headers: HeadersInit = {\n    ...init.headers,\n    'GitHub-Is-React': 'true',\n  }\n\n  return verifiedFetch(path, {...init, headers})\n}\n\n/**\n * A Fetch function which will automatically add the GitHub-Is-React header for\n * making JSON requests. It will in turn call verifiedFetchJSON.\n *\n * Using this in React components to fetch data enables us to track these\n * requests in Datadog in the request.dist.referrer metric.\n */\nexport function reactFetchJSON(path: string, init?: JSONRequestInit): Promise<Response> {\n  const initHeaders: HeadersInit = init?.headers ?? {}\n\n  const headers: HeadersInit = {\n    ...initHeaders,\n    'GitHub-Is-React': 'true',\n  }\n\n  return verifiedFetchJSON(path, {...init, headers})\n}\n"],"names":["experimentsLocalStorageKey","experimentsDebugScoringKey","getBlackbirdExperiments","experiments","safeStorage","getItem","split","setBlackbirdExperiments","setItem","join","debugScoringInfoEnabled","enabled","setDebugScoringInfoEnabled","removeItem","containsQualifier","node","qualifierKind","isQualifier","qualifier","hasChildren","child","children","CaretPositionKind","isSavedQualifier","slashRegex","shouldRedirectInsteadOfSearch","path","isContentNode","content","value","toString","matchAll","length","startsWith","redirectURL","map","encodeURIComponent","undefined","extractTextQuery","filter","x","kind","extractRepoOrgScopes","flat","restrictToScopedOrgs","orgs","repoOrgScopes","Set","scope","includes","s","toLowerCase","size","org","has","safeLocalStorage","HistoryProvider","EventTarget","handleEvent","event","state","parsedMetadata","caretPositionKind","Text","query","suggestions","JSON","parse","trimmedQuery","trim","seen","item","suggestionCount","suggestion","historyQuery","dispatchEvent","SearchItem","icon","Octicon","Search","priority","action","url","constructor","queryBuilder","name","singularItemName","type","addEventListener","PopularLanguages","color","LanguagesProvider","Language","term","caretSelectedNode","slice","r","toUpperCase","fuzzyQuery","replace","filterSort","score","fuzzyScore","text","compare","rewriteStart","location","end","rewriteEnd","start","quotedName","newQuery","FilterItem","replaceQueryWith","moveCaretTo","manuallyDetermineFilterEligibility","document","createElement","tmpl","html","renderInto","innerHTML","ReposProviderBase","getMatchingRepositories","scopedOrgs","ast","scopes","isScopedToRepository","push","Repository","getSuggestions","matches","find","o","input","ReposFilterProvider","hasFocus","Owner","Repo","ReposSearchProvider","CustomScopeCache","set","get","len","clear","SavedScopeProvider","fetchSuggestions","data","response","fetch","method","mode","headers","Accept","ok","json","Saved","String","customScopesCache","endsWith","queryStart","queryEnd","trimEnd","Bookmark","PlusCircle","commandName","customScopesUrl","OwnersProvider","FixedValuesProvider","OtherQualifier","Is","isLicense","isLanguage","getPossibleQualifierValues","chooseSearchType","t","quotedValue","Circle","TeamsProvider","team","Team","ProjectsProvider","p","Project","BlackbirdProvider","result","fetchData","FetchDataEvent","suggestionsEmitted","trailingSlashPos","lastIndexOf","filename","substring","truncatePath","repoPrefix","repository_nwo","separator","encodedPath","FileCode","description","commit_sha","line_number","SymbolKind","symbol","fully_qualified_name","prefixText","fullName","prefixColor","prefixColorForSymbolKind","plColor","PrefixColor","Entity","Constant","Keyword","Variable","Path","isLoggedIn","urlParams","URLSearchParams","saved_searches","stringify","customScopes","getAttribute","blackbirdCaches","setupWarmCachesLoop","failed","BlackbirdPermissionCaches","InputProvider","orgNode","rawQuery","isFallbackSuggestion","repo","user","astNode","parseString","qualifierNodes","raw","containsScopes","unshift","getPathQualifier","pathname","m","treeRegex","exec","i","buildRegexQuery","decodeURIComponent","escaped","replaceAll","window","getQualifierType","copilotChatEnabled","InitialExplorePages","title","octicon","ExplorePages","ExploreProvider","isHomePagePath","isMarketingPagePath","some","page","resultsPriority","Promise","resolve","DEFAULT_NL_SEARCH_QUERY","CopilotProvider","fetchIndexStatusPromise","token","fetchUrl","URL","origin","href","primerSpinner","Copilot","repoNwo","id","queryCopilotSearchDebounced","AbortController","queryCopilotSearch","getAuthToken","abort","verifiedFetchJSON","body","signal","isUpdate","CopilotError","e","Error","debounce","CopilotAuthTokenProvider","nonBreakingSpace","fromCharCode","marketing_pages_search_explore_provider_enabled","isFeatureEnabled","QbsearchInputElement","HTMLElement","placeholderText","v","parseQuery","setButtonText","parseSearchInputRaw","syncRichButtonText","flattenASTForQueryBuilder","ir","highlights","parsing","getHighlights","sort","a","b","pos","output","highlight","style","TextElementStyle","Normal","className","FilterValue","isRetainScrollPosition","connectedCallback","customElements","whenDefined","customScopesManager","initialize","feedbackDialog","HTMLDialogElement","showModal","show","globalNavVisibility","detail","setGlobalNavVisibility","setGlobalBarAlwaysExpanded","classList","add","remove","CustomEvent","appendQuery","retainScrollPosition","returnTarget","expandAndRetainScrollPosition","expand","loadParser","moveCaretToEndOfInput","saveQueryAsCustomScope","loggedInProviders","loggedOutProviders","providers","parser","parentElement","search","retract","inputSubmit","preventDefault","anchInfo","parseFileAnchor","hash","blobRange","line","SearchCopilotEvent","sendEvent","logPageView","inputButton","inputButtonText","textContent","flatten","segments","el","span","replaceChildren","newText","disconnectedCallback","getSuggestionInputState","selectedNode","visible","globalNav","querySelector","mediaQuery","matchMedia","hidden","alwaysExpanded","headerRedesignEnabled","globalBar","setGlobalBarModalOpen","modalOpen","searchInputContainerClicked","target","contains","updateQueryBuilderVisibility","queryBuilderContainer","darkBackdrop","trigger","scrollY","top","handleExpand","scrollTo","searchSuggestionsDialog","inputFocus","inputChange","element","mapURLParamToSearchType","openInNewWindow","searchType","mapSearchTypeToURLParam","softNavigate","searchParams","l","getExpandedQuery","typeParam","expandedQuery","experimentsParam","open","setLocalHistory","localStorage","MAX_LOCAL_HISTORY","handleChange","parseSearchInput","parsingPromise","now","Date","setTimeout","parseDelay","lastParsedQuery","caretData","getCaretPositionKindFromIndex","handleSubmit","editCustomScope","newCustomScope","create","stopPropagation","handleDialogClose","focus","showFeedbackDialog","submitFeedback","form","FormData","close","caretPosition","bind","handleClose","customScopesFromUrl","customScopeNames","getCustomScopeNames","Array","isArray","customScopesNeededForSearch","customScopeName","customScope","Event","bubbles","cancelable","warmCachesLoopSetup","warm","warmCaches","ttl","resp","userCacheExpiresAt","getTime","isNaN","warmResolve","AuthToken","authorizationHeaderValue","needsRefreshing","ssoOrgIds","isExpired","ssoChanged","expirationDateString","expiration","expirationDate","UTC","getUTCFullYear","getUTCMonth","getUTCDate","getUTCHours","getUTCMinutes","getUTCSeconds","getUTCMilliseconds","ssoOrgIDs","every","fromResult","orgIds","serialize","deserialize","serialized","COPILOT_AUTH_TOKEN_KEY","getLocalStorageAuthToken","validateAuthToken","fetchAuthToken","setLocalStorageAuthToken","copilotLocalStorage","currentAuthTokenRequest","_fetchAuthToken","throwQuotaErrorsOnSet","SoftNavEvent","mechanism","SoftNavStartEvent","SOFT_NAV_STATE","START","SoftNavReplaceMechanismEvent","REPLACE_MECHANISM","SoftNavSuccessEvent","visitCount","SUCCESS","SoftNavErrorEvent","error","ERROR","SoftNavEndEvent","END","initSoftNav","INITIAL","clearSoftNav","startSoftNav","inSoftNav","PROGRESS_BAR","setSoftNavMechanism","setSoftNavReactAppName","setSoftNavReferrer","markStart","replaceSoftNavMechanism","succeedSoftNav","options","canTriggerEvent","getSoftNavMechanism","endSoftNav","failSoftNav","reason","getSoftNavFailReason","DEFAULT_SOFT_NAV_ERROR_REASON","endProgressBar","sendFailureStats","unsetSoftNav","setLatestMechanism","renderedSoftNav","sendRenderStats","RENDER","updateFrame","FRAME_UPDATE","skipIfGoingToReactApp","allowedMechanisms","reactAppPresent","Object","freeze","SOFT_NAV_DURATION_MARK","MECHANISM_MAPPING","turbo","react","ui","hard","performance","clearResourceTimings","mark","turboFailureReason","sendStats","turboStartUrl","getSoftNavReferrer","turboEndUrl","duration","getDurationSinceLastSoftNav","getEntriesByName","measure","measures","pop","roundedDuration","Math","round","requestUrl","softNavigationTiming","destination","getCurrentReactAppName","initiator","getSoftNavReactAppName","SOFT_NAV_FAIL","SOFT_NAV_FAIL_REFERRER","SOFT_NAV_REFERRER","SOFT_NAV_MARK","SOFT_NAV_REACT_APP_NAME","SOFT_NAV_LATEST_MECHANISM","softNav","hasSoftNavFailure","Boolean","setSoftNavFailReason","referrer","appName","getLatestMechanism","turboOptions","visit","verifiedFetch","init","assertRelativePathOrSameOrigin","reactFetch","reactFetchJSON"],"sourceRoot":""}